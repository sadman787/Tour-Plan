#include <random>
#include <iostream>
#include <unittest++/UnitTest++.h>

#include "StreetsDatabaseAPI.h"
#include "m1.h"
#include "m3.h"
#include "m4.h"

#include "unit_test_util.h"
#include "courier_verify.h"

using ece297test::relative_error;
using ece297test::courier_path_is_legal;


SUITE(path_cost_new_york_usa_public) {
    TEST(path_cost_new_york_usa) {
        std::vector<unsigned> path;
        double turn_penalty;
        double expected;
        double actual;
        
        path = {1, 176491, 176492, 160260, 160261, 2670, 160123, 137381, 179727, 179728, 179729, 179730, 179731, 179732, 179733, 179691, 179690, 179721, 179693, 179694, 179695, 179696, 179697, 179698, 179699, 179700, 179701, 179702, 179703, 179704, 179705, 179706, 179707, 179708, 179709, 179710, 179711, 179712, 179713, 179714, 179715, 179716, 179717, 179718, 563, 562, 981, 16266, 193364};
        turn_penalty = 0;
        expected = 228.3336632915472;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {104809, 145916, 145917, 145918, 145919, 145920, 145921, 103278, 103277, 103276, 103275, 103274, 103273, 103272, 103271, 103270, 103269, 103268, 103267, 103266, 103265, 103264, 103263, 103262, 103261, 103260, 103259, 103258, 103257, 100389, 100388, 100387, 100386, 100385, 100384, 100383, 100382, 151055, 153316, 153317, 153318, 153319, 153320, 153332, 153333, 153334, 153335, 153336, 153337, 153338, 153499, 153500, 208750, 153183, 153184, 153185, 153186, 153187, 153188, 153189, 153190, 153191, 153192, 153193, 153194, 153195, 102232, 98126, 102219, 102220, 102221, 96005};
        turn_penalty = 11.47564690315255;
        expected = 581.1733211073831;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {184975, 184976, 184977, 144743, 144742, 144741, 144740, 144739, 144738, 144737, 144736, 144735, 144734, 144733, 144732, 165013, 165014, 165015, 165016, 165017, 165018, 165019, 165020, 165021, 166015, 166017, 184811, 184810, 184809, 184808, 184807, 184806, 184805, 184804, 184803, 184802, 167511, 167510, 167509, 167508, 167519, 167520, 167521, 167522, 167523, 167524, 167525, 167526, 167527, 167528, 167529, 183363, 183362, 183361, 183360, 183359, 183358, 183357, 183356, 183355, 183354, 183297, 183296, 194962, 194961, 194960, 194959, 194958, 194957, 194956, 194955, 194954, 194953, 194952, 194951, 194950, 194949, 194948, 194947, 194946, 194945, 194944, 194943, 194942, 194941, 194940, 194939, 194938, 184551, 184550, 184549, 184548, 184547, 138740, 127160, 127161, 127162, 127163, 127164, 127165, 127166, 127167, 127168, 127169, 127170, 127171, 135671, 166451, 166458, 135672, 183221, 183224, 138749, 24176, 24175, 24174, 24173, 24172, 24171, 24170, 24169, 24168, 24167, 24166};
        turn_penalty = 1.678496132715128;
        expected = 633.3929255841592;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {171348, 22251, 22252, 22253, 184181, 184182, 184183, 184184, 184185, 184186, 184187, 184188, 184189, 184190, 184191, 184353, 184323, 184324, 184325, 184326, 184327, 184328, 184329, 184330, 184331, 184332, 184333, 184334, 184335, 184336, 184337, 184338, 184339, 184340, 184341, 184342, 184343, 184344, 184345, 178007, 178008, 171372, 178009, 178010, 178011, 178012, 178013, 178014, 178015, 178016, 178648, 190182, 190183, 178649, 178650, 178651, 178652, 178653, 178628, 178629, 178630, 178631, 178632, 178633, 178634, 178635, 178636, 178637, 178638, 178639, 178640, 178641, 178642, 178643, 31858, 161867, 172935, 172930, 172931, 164899, 135294, 142522, 201905, 201906, 164917, 161862, 161863, 161864, 142594, 142592, 142587, 142588, 22801, 22802};
        turn_penalty = 44.58619277333234;
        expected = 651.4656008078922;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {195642, 195641, 195640, 195639, 195638, 195637, 195636, 195522, 195523, 195524, 195525, 195526, 195527, 195528, 195529, 195530, 195531, 195532, 195533, 195534, 195535, 195536, 195537, 195538, 167538, 152397, 209983, 222478, 222479, 222480, 222481, 152396, 152420, 125793, 125794, 152260, 125812, 125805, 125806, 125807, 125814, 125815, 152286, 152281, 152285, 164832, 125761, 125763, 125766, 125768, 125769, 125770, 125771, 129595, 149051, 149052, 149053, 149054, 129584, 147772, 147771, 147770, 147763, 129554, 129555, 129556, 129557, 129558, 129559, 149132, 129572, 129565, 129566, 103083, 103084, 129568, 222538, 222537, 222536, 222535, 222534, 222533, 105432, 222532, 99920, 99919, 99918, 99917, 99916, 99915, 99914, 99913, 99912, 99911, 99910, 99909, 149184, 149183, 149182, 149181, 149180, 149179, 149178, 149177, 149176, 149175, 149174, 149173, 149172, 201803, 201802, 201801, 201797, 201796, 201795, 201794, 83596, 83603, 83604, 84086, 84087, 84088, 84089, 84090, 85045, 85046};
        turn_penalty = 44.77880467381614;
        expected = 1185.059347808973;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {81356, 81355, 152555, 152556, 152557, 152558, 152559, 152560, 152561, 152562, 152563, 152564, 154787, 154788, 154789, 154790, 154791, 155099, 155100, 221893, 153123, 153461, 153462, 153463, 153159, 153157, 153158, 153557, 153339, 153340, 153480, 153481, 153482, 153483, 153484, 153485, 153486, 153487, 153488, 153489, 153490, 153491, 153492, 153493, 153494, 153201, 153197, 153198, 153199, 153200, 153324, 153325, 153326, 153327, 153436, 153437, 153438, 153439, 153440, 153441, 153442, 153443, 153444, 153445, 153446, 153447, 153448, 153449, 153450, 153451, 153404, 153460, 153514, 153547, 153548, 153549, 153550, 153551, 153241, 153234, 153235, 153321, 153322, 153323, 153386, 153387, 153408, 153454, 153497, 153498, 153409, 153410, 153455, 153456, 153457, 129169, 150201, 150116, 128008, 134874, 207392, 207393, 134880, 164846, 146985, 146986, 150207, 153930, 163295, 163286, 154003, 154002, 154001, 154000, 153999, 153998, 153997, 153996, 153995, 153994, 225162, 225161, 225160, 153929, 153978, 153977, 205874, 205873, 163307, 153934, 153933, 153991, 153990, 146967, 146970, 146971, 151976, 151977, 153941, 151982, 151981, 151980, 151979, 153935, 153903, 153980, 153940, 153939, 153938, 153937, 145665, 153861, 76300, 146938, 146939, 77869, 77870, 77871};
        turn_penalty = 30.33507082458858;
        expected = 1237.309152660159;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {209123, 209122, 209121, 209120, 209119, 209118, 209117, 209116, 209115, 209126, 149201, 149200, 149199, 149198, 149197, 149202, 84817, 84816, 84815, 84814, 84813, 84812, 84811, 84810, 84809, 84808, 84807, 84806, 84805, 131391, 131390, 131389, 131388, 131387, 131386, 131385, 131384, 131383, 131382, 131381, 131380, 131379, 97767, 97768, 97769, 97770, 97771, 97772, 97773, 97774, 97775, 97776, 97777, 97778, 97779, 97780, 97781, 97782, 175303, 175286, 175287, 175288, 175289, 175290, 175291, 175292, 175293, 209107, 209106, 209105, 209104, 209103, 209102, 209101, 209100, 209099, 209098, 209097, 209096, 209108, 167342, 131413, 131412, 167128, 222836, 131402, 131403, 131404, 131405, 131406, 131407, 131408, 131409, 131410, 131411, 153393, 153480, 153481, 153482, 153483, 153484, 153485, 153486, 153487, 153488, 153489, 153490, 153491, 153492, 153493, 153494, 153201, 153197, 153198, 153199, 153200, 153324, 153325, 153326, 153327, 153436, 153437, 153438, 153439, 153440, 153441, 153442, 153443, 153444, 153445, 153446, 153447, 153448, 153449, 153450, 153451, 153404, 153460, 153514, 153547, 153548, 153549, 153550, 153551, 153241, 153234, 153235, 153321, 153322, 153323, 153386, 153387, 153408, 153454, 153497, 153498, 153409, 153410, 153455, 153456, 153457, 129169, 150201, 150116, 128008, 134874, 207392, 207393, 134880, 164846, 146985, 146986, 150207, 153930, 163295, 75772, 75773, 75774, 75775, 75776, 75777, 73642, 73643, 73644, 73645, 73646, 195331, 195332};
        turn_penalty = 33.45806031895192;
        expected = 1380.511741887933;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {212724, 15244, 15243, 15242, 15241, 15240, 15239, 15238, 15237, 15236, 15235, 15234, 15233, 15232, 15231, 137818, 137819, 137820, 137821, 137822, 137823, 137824, 137825, 137826, 141597, 141596, 141613, 141598, 184201, 182823, 141594, 141599, 141558, 182827, 141547, 141548, 141549, 16632, 171840, 135023, 135024, 135025, 137565, 137566, 137567, 137568, 141390, 141386, 141393, 141394, 164926, 141402, 141401, 141396, 135026, 135027, 135034, 141366, 141364, 141365, 141377, 141374, 16293, 164941, 164942, 161435, 161436, 126434, 142558, 201289, 164933, 164930, 126600, 157185, 142589, 142590, 142591, 142633, 142634, 142637, 164911, 142641, 142642, 201893, 142552, 135519, 164903, 164904, 172936, 172939, 172940, 161861, 142518, 142519, 142214, 164907, 142204, 142199, 142200, 142195, 164890, 135139, 143131, 143132, 143124, 143123, 135145, 135146, 135147, 143076, 164918, 164888, 2958, 6833, 187801, 187802, 187803, 187804, 138799, 7060, 7061, 7062, 143206, 143207, 143208, 143283, 143284, 143285, 143286, 143287, 143288, 143289, 143290, 143291, 8830, 8831};
        turn_penalty = 17.54021232368054;
        expected = 1381.30429547268;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {9673, 9674, 9675, 9676, 9677, 9678, 9679, 9680, 9681, 9682, 9683, 9684, 9685, 9686, 9687, 9688, 9689, 9690, 9691, 9692, 186410, 186409, 186408, 189715, 189714, 189700, 189701, 189702, 189703, 189704, 189705, 189706, 189707, 189708, 189709, 189710, 144253, 144254, 144255, 186325, 186326, 186315, 186316, 186317, 186064, 186065, 186066, 173792, 173793, 173854, 173920, 173921, 173922, 173923, 173924, 173925, 173926, 173927, 173928, 173929, 173930, 173931, 173932, 173933, 173934, 173935, 173936, 173937, 173938, 173939, 173940, 173941, 173942, 173943, 173944, 173945, 173946, 173947, 173948, 173949, 173950, 173951, 173952, 173953, 173954, 173955, 173956, 173957, 173958, 173959, 173960, 173961, 173962, 173963, 173964, 173965, 173966, 173967, 173968, 173889, 173890, 144925, 134270, 189114, 189115, 189116, 189117, 182205, 144960, 144957, 144958, 144959, 144942, 187393, 187394, 165044, 144948, 144949, 144950, 144951, 144952, 144953, 144954, 144955, 144956, 183856, 183857, 183858, 183859, 165043, 183861, 165022, 165023, 165024, 165025, 165026, 165027, 165028, 165029, 165030, 165031, 165032, 165033, 165034, 165035, 165036, 165037, 165038, 165039, 165040, 166016, 166008, 173659, 184797, 184796, 184795, 184794, 184793, 184792, 184791, 184790, 184801, 184800, 184799, 184798, 184635, 184634, 184633, 184632, 184631, 184630, 184629, 184628, 184627, 184626, 184625, 184624, 184623, 184622, 184621, 184620, 184619, 184618, 184617, 184616, 184615, 184614, 184613, 184612, 184611, 184610, 184609, 184608, 184607, 184606, 184605, 184604, 184603, 184602, 184601, 184600, 184599, 184598, 144760, 144759, 144758, 144757, 144756, 144755, 144754, 144753, 144752, 144751, 144750, 144749, 144748, 144747, 144746, 144745, 184597, 184596, 26828, 26827, 26826, 26825, 26824, 26823};
        turn_penalty = 35.11650428888172;
        expected = 1402.256472930919;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {192010, 198029, 198030, 198031, 198032, 191942, 191943, 205389, 205390, 205391, 157880, 197978, 198007, 198006, 198005, 198004, 198003, 198002, 198001, 198000, 197999, 191956, 198023, 198024, 198025, 191975, 191974, 191958, 148074, 148075, 148076, 148078, 148079, 148080, 44956, 136993, 171851, 136992, 136990, 136980, 136981, 136982, 136983, 136984, 128324, 136922, 136921, 136920, 136919, 136928, 127604, 136999, 137000, 127611, 127612, 147602, 147603, 161381, 165570, 150399, 150400, 150401, 148759, 148760, 148758, 195461, 146958, 165557, 146937, 146948, 150396, 150397, 150395, 150390, 150391, 150392, 150388, 150389, 165577, 165576, 148859, 148860, 148861, 148862, 148863, 148864, 165560, 165561, 165562, 165563, 165564, 128780, 128782, 150369, 150370, 150364, 158785, 207186, 207187, 158789, 73715, 73716, 73717, 73718, 132197, 132198, 132199, 132200, 132201, 132202, 132203, 137987, 65027};
        turn_penalty = 23.17018073295285;
        expected = 1406.629851539278;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {12187, 14574, 14573, 140743, 140744, 159195, 44646, 163456, 163457, 163458, 163459, 12564, 193325, 193326, 135004, 202068, 202069, 202070, 202071, 202072, 202073, 202074, 202075, 202076, 193520, 136728, 136729, 136730, 136731, 136732, 136733, 136734, 136735, 136736, 136737, 194437, 194438, 194439, 194440, 194564, 194565, 194408, 194409, 194410, 11258, 141773, 141767, 141768, 141769, 171807, 171808, 44431, 44432, 132706, 164623, 140489, 132700, 44590, 164590, 140476, 140446, 159123, 140456, 141053, 146812, 128461, 128462, 136116, 136119, 136105, 136106, 44537, 147393, 128720, 128610, 128721, 155111, 136201, 136165, 136166, 136181, 136167, 136168, 136169, 136170, 136171, 136172, 156352, 136335, 136336, 136377, 136337, 136373, 136338, 136339, 136366, 128639, 136369, 136348, 136349, 136351, 136352, 136353, 136354, 147388, 128424, 192985, 136281, 136282, 136294, 136238, 136239, 136240, 136241, 136242, 136243, 156430, 128451, 128452, 156794, 156795, 156796, 156762, 192987, 192988, 128453, 156867, 156866, 50808, 51812, 51813, 156825, 156826, 156827, 156828, 156829, 156830, 45134, 45133, 45132, 45131, 45130, 45129, 45128, 45127, 45126, 45125, 45124, 45123, 57366, 57367, 57368, 57369, 57370, 57371, 57372, 57373, 57374, 57375, 57376, 157867, 157861, 157862, 157863, 157864, 157865, 157866, 163436, 163435, 163434, 57539, 57538, 57537, 148347, 157856, 154508, 154509, 154510, 154511, 154512, 44878, 163339, 163340, 163341, 163342, 163343, 148085, 127622, 163330, 163331, 163332, 163333, 163334, 163335, 94691, 128377, 128378, 131316, 131317, 131324, 131325, 146933, 146936, 153841, 153842, 153843, 88092, 138026, 130851, 90807, 90806, 138054, 138039, 138038, 138037, 218143, 218142, 218141, 218144, 138053, 130825, 199488};
        turn_penalty = 1.917191447300373;
        expected = 1420.88714724743;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {110061, 110434, 108152, 14440, 44583, 44582, 44581, 134585, 157037, 135483, 44414, 44415, 44416, 147303, 147304, 147294, 147279, 147280, 147281, 147282, 135484, 147283, 147284, 147285, 147286, 147287, 147288, 147289, 147290, 147291, 165264, 141601, 164973, 182821, 161438, 164975, 135604, 32527, 182820, 165076, 161424, 161425, 161426, 161427, 166145, 166146, 165075, 139860, 126175, 165068, 165060, 126191, 126192, 126193, 126194, 32528, 32529, 32530, 32531, 32532, 165067, 173239, 127265, 165052, 127266, 173345, 159390, 173271, 35359, 166090, 166071, 166072, 138828, 127268, 127269};
        turn_penalty = 26.06136747164377;
        expected = 1421.059362150785;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {177328, 177327, 177326, 177325, 177324, 177323, 177322, 139444, 139443, 139442, 179678, 179677, 132719, 199744, 141137, 105826, 141121, 141183, 141184, 141185, 141272, 141248, 141239, 141240, 141241, 141214, 135035, 141204, 141205, 141206, 141376, 141373, 16293, 164941, 164942, 161435, 161436, 126434, 142558, 201289, 164933, 164930, 164931, 135452, 135453, 165186, 165187, 165201, 165202, 165203, 165204, 165205, 165206, 165207, 165184, 165185, 165208, 165209, 165210, 165211, 165212, 165213, 165214, 165218, 166113, 134810, 134811, 165215, 17624, 20471, 20472, 20473, 20474, 20475, 20476, 166118, 166119, 166120, 196786, 196787, 196788, 196789, 196790, 196791, 196792, 196793, 196794, 184406, 184407, 184408, 181511, 32295, 32296, 32297, 181499, 181500, 181501, 144788, 181664, 181665, 144778, 144779, 159343, 159344, 159345, 159346, 159347, 159348, 159349, 159350, 159351, 159352, 159353, 159354, 159355, 159356, 159357, 159358, 159359, 159360, 181667, 181668, 181669, 181670, 181671, 181672, 181673, 181674, 184701, 184702, 33450};
        turn_penalty = 25.71679010554763;
        expected = 1480.363451632553;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {103667, 101167, 101168, 101169, 210540, 70302, 70303, 157409, 157410, 157411, 157412, 125851, 128540, 168901, 168902, 165595, 128609, 157601, 157603, 157602, 157596, 157604, 157605, 157597, 165591, 141379, 141380, 165584, 165586, 165593, 161379, 161380, 171155, 134960, 151034, 64385, 105837, 128612, 128613, 128614, 128625, 160986, 128636, 128637, 160923, 205485, 127810, 128632, 128633, 128642, 160929, 160930, 160931, 128065, 128066, 128072, 128073, 128074, 127767, 205497, 127768, 127769, 127770, 147570, 147571, 147572, 164487, 150218, 164485, 164486, 105993, 154585, 58, 207548, 207549, 65, 138204, 160270, 1642, 1643, 1644, 1645, 1646, 1647, 1648, 1649, 1650, 105895, 105894, 105893, 139304, 202080, 138932, 138931, 170941, 170940, 170939, 170938, 170937, 170936, 268, 269, 270, 271, 188001, 188002, 188003, 188004, 198653, 198654, 198655, 135469, 139766, 135459, 139765, 8859, 8860, 8861, 138771, 138772, 188010, 184288, 188101, 143188, 143187, 184295, 184296, 184297, 184298, 184299, 184300, 184301, 184302, 184303, 184304, 184305, 184306, 184307, 184308, 184309, 184310, 184311, 184312, 184313, 184314, 184315, 184316, 184317, 184318, 184319, 197391, 197392, 197393, 223586, 188793, 188725, 187248, 187249, 187250, 187251, 187252, 187300, 187301, 187302, 187303, 187304, 187305, 187306, 187307, 187308, 187309, 187310, 187311, 187312, 197540, 188072, 188073, 188074, 188075, 188076, 188077, 182999, 183000, 188588, 188628, 188629, 188630, 188631, 188632, 188633, 188959, 188960, 188961, 188962, 188963, 188964, 188965, 188966, 188967, 188968, 188969, 188970, 188971, 188972, 188973, 188974, 188975, 188976, 186017, 186018, 188373, 188374, 186013, 186014, 186015, 186016, 187685, 188208, 188181, 188182, 188183, 188184, 188185, 188186, 188187, 188188, 188189, 188190, 188191, 188192, 188193, 188194, 188195, 188196, 188197, 8101, 139010, 139011, 6047, 6048, 6046, 142949, 142971, 3011, 3012, 3013, 3014, 187683, 187684, 182973, 182974, 182975, 182976, 182977, 182978, 182979, 182980, 182981, 182982, 182983, 182984, 182985, 182986, 182987, 182988, 182989, 182990, 182991, 182992, 182993, 182994, 182995, 182996, 182997, 10027, 181424, 181413, 181417, 186960, 186961, 181408, 181414, 181415, 181416, 181410, 181418, 181419, 181420, 181421, 181422, 181423, 181411, 181412, 181409, 145028, 145029, 145030, 134270, 189114, 189115, 189116, 189117, 182205, 144960, 144957, 144958, 144959, 144942, 134260, 187388, 173779, 134343, 170197, 170188, 170187, 170127, 169893, 169964, 169866, 169867, 169868, 169869, 169870, 169871, 169872, 169873};
        turn_penalty = 0;
        expected = 1747.515806304788;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {12272, 12273, 12274, 160895, 140724, 140723, 138337, 141420, 141405, 11285, 141525, 141526, 141527, 44691, 141477, 141489, 44647, 141486, 141487, 11335, 141496, 141497, 171806, 171811, 141751, 141754, 141755, 134415, 137626, 141773, 141767, 141768, 141769, 171807, 171808, 44431, 44432, 132706, 164623, 140489, 132700, 44590, 164590, 140476, 140446, 159123, 140456, 141053, 146812, 128461, 128462, 136116, 136119, 136105, 136106, 147391, 164716, 224881, 224882, 159138, 128432, 128433, 136427, 136381, 136382, 136405, 136407, 136945, 136946, 136947, 128407, 128408, 128399, 136311, 136312, 136318, 129058, 136235, 136236, 136237, 149504, 149502, 149503, 149516, 149515, 165435, 165436, 168605, 137213, 150665, 150666, 149430, 149429, 149421, 149418, 149419, 149420, 129118, 134126, 134124, 134125, 137939, 150678, 137940, 150676, 150677, 137942, 150675, 137874, 150671, 137876, 150670, 137871, 150679, 150680, 87909, 137861, 152822, 152823, 88151, 163303, 163304, 163305, 90349, 90348, 90347};
        turn_penalty = 36.43049940423171;
        expected = 1755.362400594358;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {206386, 206387, 207274, 207273, 207272, 207271, 207270, 207269, 207268, 207267, 207266, 207265, 207264, 207263, 207262, 207261, 207260, 207259, 207258, 191794, 191793, 67717, 67716, 67715, 67714, 67713, 67712, 67711, 67710, 154014, 154020, 154019, 154018, 62513, 195505, 195506, 73079, 73080, 73081, 73082, 73083, 73084, 73085, 167023, 167022, 167021, 167024, 167025, 64653, 64654, 131229, 131230, 131231, 75874, 146960, 146961, 146962, 146963, 146964, 195454, 195455, 195456, 195457, 195449, 195450, 195451, 195452, 195453, 206968, 206969, 206970, 206971, 206972, 206973, 206974, 206975, 206976, 206977, 206978, 206979, 206980, 206981, 206982, 78809, 127609, 127610, 150259, 150260, 221875, 221876, 129756, 129755, 129754, 129753, 129752, 129757, 129758, 129759, 147591, 147592, 147593, 129760, 147606, 147583, 147584, 147585, 147586, 163312, 78808, 77819, 128244, 128245, 163291, 147578, 163292, 163293, 177768, 177806, 177807, 177810, 177741, 177742, 128870, 151720, 147381, 151732, 151731, 151824, 167562, 151825, 127844, 127865, 150249, 164855, 127763, 127764, 127765, 127766, 165654, 147570, 147571, 147572, 164487, 150218, 164485, 164486, 105993, 154585, 58, 207548, 207549, 65, 138204, 160270, 1642, 1643, 1644, 1645, 1646, 1647, 1648, 1649, 1650, 105895, 105894, 105893, 139304, 202080, 138932, 138931, 170941, 170940, 170939, 170938, 170937, 170936, 268, 269, 270, 271, 188001, 188002, 188003, 188004, 198653, 198654, 198655, 135469, 135468, 139762, 139764, 135474, 135149, 139760, 165322, 135166, 143077, 164919, 164923, 143205, 143126, 143125, 143133, 143130, 135520, 164915, 142194, 142201, 164902, 142198, 142203, 126531, 161857, 161858, 161865, 161866, 161867, 172935, 172930, 172931, 164899, 135294, 142522, 201905, 142639, 161859, 178597, 178596, 178595, 178594, 178593, 178592, 178591, 178590, 178589, 178588, 178587, 178586, 178585, 178584, 178583, 178582, 178581, 177998, 177997, 177996, 177995, 177994, 177993, 177992, 177991, 177990, 177989, 177988, 177987, 177986, 177985, 177984, 177983, 177982, 177981, 177980, 177979, 177978, 177977, 177976, 177975, 177974, 177973, 177972, 177971, 177970, 177969, 177968, 139896, 126259, 126260, 19765, 166269, 166270, 126307, 166265, 126409, 126410, 166280, 166277, 166278, 190040, 126240, 126241, 126242, 126243, 126244, 126245, 126238, 126239, 126146, 177999, 183018, 183019, 182370, 126147, 126148, 126149, 126150, 126151, 126152, 126153, 126154, 126155, 126156, 126157, 126158, 126159, 126160, 126161, 126162, 126163, 126164, 126165, 25432, 25433, 25434, 25435, 25436, 25437, 25438, 25439, 25440, 25441, 25442, 25443, 202159, 202158};
        turn_penalty = 0;
        expected = 1760.397463005444;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {137330, 137331, 137332, 105843, 105844, 105845, 105846, 105847, 105848, 105849, 105850, 44869, 137811, 155259, 156545, 156544, 156551, 156550, 134146, 134147, 156552, 156558, 134148, 149251, 134143, 134120, 156562, 156561, 156570, 156569, 156568, 156567, 128983, 158088, 158089, 158090, 163383, 152843, 152856, 137497, 152848, 137492, 152835, 152834, 152825, 152826, 224807, 224808, 224809, 149724, 224798, 224799, 224800, 149713, 224806, 224805, 149712, 149706, 224803, 164860, 149707, 149704, 149705, 149699, 149698, 149697, 149690, 149691, 149692, 131351, 131352, 131353, 131354, 131337, 224792, 224793, 224794, 224795, 224796, 224789, 224797, 224790, 224791, 156322, 156325, 156326, 224784, 224785, 224786, 131304, 131302, 131303, 131239, 131238, 131243, 131240, 131241, 131242, 127632, 131253, 131232, 131233, 127633, 127631, 134881, 153901, 153921, 153897, 153898, 153937, 153938, 153939, 153940, 153980, 153903, 153935, 151979, 151980, 151981, 151982, 153941, 146968, 146969, 151975, 146967, 153990, 153991, 153933, 153934, 163307, 205873, 205874, 153977, 153978, 153929, 225160, 225161, 225162, 153994, 153995, 153996, 153997, 153998, 153999, 154000, 154001, 154002, 154003, 163286, 163295, 146993, 154006, 154007, 150208, 164845, 147004, 147005, 147006, 128000, 164182, 207310, 150122, 150123, 150124, 150125, 208813, 208814, 207301, 207302, 207303, 207304, 207305, 207306, 150170, 164181, 164186, 164187, 164188, 150203, 147383, 130688, 130689, 153293, 153294, 153295, 153296, 153361, 153362, 153394, 153434, 153474, 153475, 153518, 153519, 153520, 153521, 153554, 153236, 153242, 153243, 153523, 153435, 153476, 153477, 153478, 99396, 99395, 99394, 99393, 99392, 99391, 99390, 99389, 99388, 99387, 99386, 99385, 99384, 98891, 99402, 161343, 161342, 161344, 104961, 105429, 97119};
        turn_penalty = 12.22740171002416;
        expected = 1857.956498985659;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {209496, 209495, 163599, 163600, 163517, 142749, 142748, 163577, 178725, 178726, 178727, 178714, 178715, 178716, 178717, 178718, 178719, 178720, 178721, 178722, 178723, 178724, 209401, 209402, 209403, 209404, 209405, 209406, 209407, 209408, 209409, 178713, 163538, 138624, 138625, 163543, 163544, 163545, 163546, 163547, 23858, 207547, 207546, 178648, 190182, 190183, 178649, 178650, 178651, 178652, 178653, 178628, 178629, 178630, 178631, 178632, 178633, 178634, 178635, 178636, 178637, 178638, 178639, 178640, 178641, 178642, 178643, 31858, 161867, 172935, 172930, 172931, 164899, 135294, 142522, 201905, 201906, 164917, 161862, 161863, 161864, 142594, 142592, 142593, 126459, 126458, 17682, 126435, 161431, 164932, 142559, 44639, 139861, 164943, 164944, 161420, 11406, 141375, 141378, 141362, 141370, 136051, 141212, 141210, 141211, 164682, 141235, 141236, 164681, 141238, 141244, 141245, 141180, 141181, 141182, 141122, 141123, 136054, 44447, 44448, 141097, 141104, 141105, 141100, 164623, 140489, 132700, 44590, 164590, 140476, 140446, 159123, 140456, 141053, 146812, 128461, 128462, 136116, 136119, 136105, 136106, 147391, 164716, 224881, 224882, 159138, 128432, 128433, 136427, 136381, 136382, 136405, 136407, 136945, 136946, 136947, 128407, 128408, 128399, 136311, 136312, 136318, 129058, 136235, 136236, 136237, 149504, 149502, 149503, 149516, 149515, 165435, 165436, 168605, 137213, 150665, 150666, 149430, 149429, 149421, 149418, 149419, 172063, 172064, 172065, 129093, 129094, 134145, 156554, 156553};
        turn_penalty = 13.2311767140731;
        expected = 1888.985734025899;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {27796, 166062, 166061, 181972, 181973, 181974, 173240, 173241, 181961, 181962, 181963, 181964, 181965, 181966, 181967, 138678, 138679, 166084, 166085, 184101, 184102, 184103, 184104, 184105, 184106, 184107, 184108, 215716, 215717, 215718, 215719, 222349, 222350, 222351, 222352, 222353, 222354, 222355, 211637, 211638, 216347, 216348, 216349, 216353, 216354, 222373, 222374, 222375, 222376, 222377, 222365, 222366, 222367, 222368, 222369, 222370, 222371, 222372, 215905, 215906, 215907, 215344, 215345, 215346, 215347, 215337, 215338, 215339, 215340, 215341, 215342, 215343, 215350, 215351, 222313, 222314, 222315, 222316, 222317, 222318, 222319, 142873, 142874, 142875, 142876, 142877, 142878, 142879, 142880, 142881, 142882, 142883, 142884, 142885, 142886, 142887, 142888, 142889, 142890, 142891, 142892, 142893, 142894, 142895, 142896, 142897, 182947, 182948, 182949, 182950, 222509, 222508, 222507, 142804, 142805, 142806, 142807, 142808, 142809, 142810, 142811, 142812, 142813, 142814, 142815, 142816, 142817, 142818, 142819, 142820, 142821, 142822, 142823, 142824, 142825, 142826, 142827, 142828, 142829, 142830, 142831, 142832, 142833, 142834, 142835, 142836, 142837, 142838, 142839, 142840, 142841, 142842, 142843, 142844, 142845, 142846, 142847, 142848, 142849, 142850, 142851, 142852, 188950, 188951, 188952, 188953, 188954, 188955, 188956, 189265, 189264, 189263, 188946, 188945, 188947, 188948, 188949, 224958, 224959, 224960, 224961, 224962, 224963, 224964, 224965, 224966, 224967, 224968, 224969, 224970, 197729, 197723, 197724, 197725, 197726, 197727, 197728, 222925, 222926, 222933, 222934, 222941, 222942, 222943, 6993, 138420, 189983, 138421, 143585, 143586, 143584, 143587, 164913, 164914, 164910, 164908, 143746, 143747, 143748, 143749, 133614, 133615, 133616, 133617, 161419, 164920, 164921, 143903, 164912, 44616, 143882, 44213, 44214, 173223, 173212, 173184, 173197, 173325, 173312, 173314, 173309, 133588, 133589, 133590, 133591, 133592, 133593, 190765, 131846, 168865, 168866, 190781, 38280, 38281, 38282, 38283, 38284, 159773, 159774, 159775, 190802, 190803, 190804, 190805, 190806, 190807, 190808, 190809, 190810, 190811, 190812, 190813, 190814, 190815, 190816, 213428, 213429, 213436, 213437, 213438, 213439, 213440, 213441, 213442, 213443, 213444, 213445, 221594, 221583, 221584, 221585, 221586, 221587, 221588, 221589, 221590, 221591, 221592, 221593, 216689, 216690, 216691, 216692, 216693, 216706, 216708, 216709, 216710, 216711, 213652, 213653, 213654, 213655, 213656, 213657, 213658, 213659, 190751, 190752, 190753, 190754, 190755, 190756, 190757, 190758, 190759, 190760, 190761, 190782, 190783, 190784, 190785, 190786, 190787, 190788, 190789, 190790, 190791, 190792, 190793, 190794, 190795, 206028, 206029, 206030, 206031, 206032, 206033, 206034, 206035, 206036, 206037, 206061, 206062, 206063, 206064, 206004, 206005, 206006, 206007, 206008, 206009, 206010, 206011, 222666, 222665};
        turn_penalty = 4.316860293722849;
        expected = 1900.064024083032;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {121632, 120127, 119892, 119893, 119894, 119895, 26570, 183544, 183545, 183546, 183547, 182341, 139895, 139894, 139893, 139892, 139891, 139890, 139889, 139888, 139887, 139886, 139885, 139884, 139883, 139882, 139881, 139880, 139879, 131635, 131634, 126916, 126917, 209744, 139874, 139875, 139876, 139877, 139878, 182381, 182380, 182379, 182378, 182377, 182376, 182375, 182374, 182373, 182372, 182371, 149263, 149262, 149261, 149260, 149259, 149258, 149257, 149256, 149255, 149254, 35700, 172675, 135772, 149275, 149276, 149277, 149278, 161418, 135602, 165281, 135046, 170292, 165283, 165284, 165285, 11149, 134194, 134195, 141689, 141690, 165161, 141685, 141684, 165162, 11326, 165165, 141566, 141570, 11151, 11152, 11153, 134509, 134510, 134511, 134512, 134513, 141743, 137969, 141498, 141499, 141497, 171806, 171811, 141751, 141754, 141755, 134415, 137626, 141773, 141767, 141768, 141769, 171807, 171808, 44431, 44432, 132706, 164623, 140489, 132700, 146816, 164589, 140480, 140455, 164588, 105805, 44534, 146815, 44369, 165545, 136195, 136196, 136173, 164695, 147392, 44541, 136198, 44549, 155110, 128463, 155112, 155113, 155114, 155115, 155116, 155117, 136437, 136214, 163266, 163267, 163268, 136439, 136224, 136225, 136226, 136412, 136228, 136229, 136230, 155130, 155133, 155134, 155135, 155148, 155149, 155150, 155151, 155152, 155153, 155154, 155155, 155163, 155164, 155165, 155166, 155167, 148688, 148687, 148676, 148677, 148678, 148679, 148680, 148651, 148652, 148653, 192822, 128556, 128554, 128555, 192823, 148600, 148597, 148598, 148599, 137326, 137327, 137328, 137562, 137564, 155231, 148583, 155243, 155239, 155240, 155241, 155242, 224910, 224909};
        turn_penalty = 18.53930724171296;
        expected = 1926.681136784809;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {193921, 193922, 193923, 193924, 193925, 193926, 193927, 193928, 193929, 193930, 193931, 193932, 193933, 193934, 193935, 193936, 193937, 194284, 194285, 194286, 194287, 194288, 199520, 199521, 171837, 171808, 44431, 44432, 132706, 164623, 140489, 132700, 44590, 164590, 140476, 140446, 159123, 140456, 141053, 146812, 128461, 128462, 136116, 136119, 136105, 136106, 147391, 164716, 224881, 224882, 159138, 128432, 128433, 136427, 136381, 136382, 136405, 136407, 136945, 136946, 136947, 128440, 44924, 136024, 136025, 136019, 136013, 50965, 50966, 136249, 136203, 136204, 127635, 136957, 136951, 136960, 136961, 136962, 136963, 136965, 136966, 136967, 136968, 158994, 158995, 158996, 158997, 158998, 136988, 136989, 136995, 136994, 136991, 171846, 136992, 136990, 136980, 136981, 136982, 136983, 136984, 128324, 136922, 136921, 136920, 136919, 136928, 136929, 136927, 136926, 136925, 136924, 145924, 145925, 136797, 136798, 136850, 161617, 161608, 136862, 164709, 134740, 161573, 161644, 164713, 134942, 134950, 134951, 136642, 136643, 136644, 136645, 137236, 137232, 161307, 161482, 161475, 161478, 161492, 161491, 161490, 161489, 161488, 161498, 161500, 161506, 161507, 161508, 161514, 161515, 161518, 161553, 161547, 161548, 161542, 161543, 161533, 161532, 161534, 161535, 161524, 161523, 161522, 136633, 96025, 136565, 171849, 133562, 133474, 108683, 108682, 108680, 164935, 161176, 133472, 161168, 171114, 161169, 133477, 133475, 136580, 136581, 136582, 171855, 136575, 161308, 161521, 161520, 161519, 161528, 161529, 161530, 161531, 161544, 161545, 161558, 161546};
        turn_penalty = 30.26936737054029;
        expected = 2083.613396228707;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {115139, 115013, 115012, 115011, 115010, 115009, 115008, 115007, 127334, 127333, 127332, 127331, 116759, 116760, 116761, 116762, 185187, 185188, 185189, 185190, 185191, 185192, 185193, 185194, 185195, 185196, 185197, 185198, 185199, 185200, 202178, 127391, 127392, 140023, 166416, 166413, 166407, 21312, 166408, 166409, 166410, 184998, 184999, 185000, 185001, 185002, 184972, 184973, 184974, 184975, 184976, 184977, 140024, 140025, 140026, 140027, 140028, 140029, 140030, 140031, 140032, 140033, 134271, 134272, 134273, 134274, 159104, 159105, 159106, 159107, 159108, 159109, 159110, 159111, 159112, 159113, 159114, 181778, 181779, 181780, 181781, 181782, 181783, 181784, 181785, 181786, 184082, 184083, 184084, 184059, 184060, 184061, 173251, 134275, 161323, 161315, 161316, 161317, 161318, 161319, 161320, 161337, 161338, 161339, 161340, 161341, 127258, 127259, 127260, 165059, 126788, 126900, 126901, 126902, 126903, 126904, 126704, 126705, 126706, 126707, 139859, 165069, 165054, 165055, 165057, 165071, 166140, 166141, 166142, 166143, 166144, 165074, 182819, 125911, 125912, 165077, 165078, 161429, 125973, 44578, 164974, 161441, 182822, 11242, 224170, 46145, 141559, 141560, 164960, 50505, 141571, 11151, 11152, 11153, 134509, 134510, 134511, 134512, 134513, 141743, 137969, 141498, 141499, 141497, 171806, 171811, 141751, 141754, 141755, 134415, 137626, 141773, 141767, 141768, 141769, 171807, 171808, 44431, 44432, 132706, 164623, 140489, 132700, 146816, 164589, 140480, 140455, 164588, 105805, 44534, 146815, 44369, 165545, 136195, 136196, 136173, 164695, 147392, 44541, 136198, 44549, 155110, 128463, 155112, 155113, 155114, 155115, 155116, 155117, 136437, 136214, 163266, 44876, 44877, 155126, 155125, 58881, 58882, 58883, 58884, 58885, 58886, 58887, 58888, 58889, 58890, 58891, 58892, 58893, 49742, 49741, 51319, 51320, 51321, 51322, 51323, 51324, 51325, 51326, 51327, 51328, 51329, 155623, 155624, 155625, 155626, 155627, 49888, 49887};
        turn_penalty = 3.429819050882873;
        expected = 2088.378946268395;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {172353, 172331, 172332, 134171, 224923, 189747, 197133, 189748, 189764, 197105, 197100, 179267, 179263, 179264, 179265, 165127, 129746, 145031, 145020, 145021, 144939, 34098, 144928, 164984, 145484, 145485, 145486, 145483, 145482, 17769, 165083, 159136, 165056, 165977, 165975, 173238, 165978, 161313, 161314, 161315, 161316, 161317, 161318, 161319, 161320, 161337, 161338, 161339, 161340, 161341, 127258, 127259, 127260, 165059, 126788, 126900, 126901, 126902, 126903, 126904, 126704, 126705, 126706, 126707, 139859, 165069, 165054, 165055, 165057, 165071, 166140, 166141, 166142, 166143, 166144, 165074, 182819, 125911, 125912, 165077, 165078, 161429, 125973, 44578, 164974, 161441, 182822, 141600, 165246, 165254, 165255, 165256, 165257, 165258, 165259, 165260, 165261, 165262, 165263, 135485, 141632, 141633, 141634, 147295, 147296, 147297, 147298, 147299, 165247, 147316, 147310, 147311, 147309, 147305, 147317, 147318, 165884, 165885, 165886, 166226, 166233, 166228, 165893, 166239, 165875, 165873, 165898, 109843, 166221, 147324, 110244, 110243, 110242, 110241, 110240, 110239, 110238, 110237, 110236, 110235, 110234, 110233, 110232, 110231, 110230, 110229, 107222, 107223};
        turn_penalty = 43.26898993091054;
        expected = 2348.635030070743;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {108678, 108677, 137741, 137742, 137743, 137744, 137745, 108661, 108660, 106653, 106654, 106655, 106601, 106602, 147548, 147519, 147520, 163534, 163535, 163536, 44516, 165233, 165234, 174426, 174427, 137800, 137801, 137790, 137791, 137792, 137793, 137794, 137795, 137796, 137797, 137798, 161587, 106313, 44428, 44429, 132757, 161583, 132758, 218810, 218808, 218809, 165230, 165242, 140357, 140354, 140355, 140356, 218921, 218923, 140317, 140318, 140329, 106039, 106040, 140301, 140302, 140303, 140304, 140306, 140307, 140308, 140283, 140284, 140285, 171655, 106076, 106077, 139939, 159191, 159192, 160073, 160074, 160075, 160076, 171447, 171448, 171449, 171450, 171451, 171489, 163601, 163602, 163603, 163604, 163605, 163606, 163607, 163608, 159163, 159164, 159165, 159166, 176233, 176234, 176235, 132944, 224912, 224913, 224914, 224915, 132940, 132941, 162060, 162061, 162062, 162063, 162064, 162065, 162075, 106005, 106006, 106007, 162074, 162073, 162072, 162071, 66, 67, 106082, 141030, 154586, 44376, 164484, 150220, 150221, 150222, 150243, 150256, 127843, 164856, 150250, 160867, 160866, 151828, 151826, 151827, 167561, 150252, 147372, 147373, 147374, 147375, 147376, 129163, 147385, 147635, 147636, 147637, 147638, 147640, 147639, 147641, 147642, 147643, 147644, 147645, 147646, 147715, 147647, 134930, 134931, 207312, 129159, 207313, 134926, 127994, 127995, 127996, 127997, 127998, 127999, 72160, 134878, 134877, 141383, 150121, 164191, 150139, 150138, 125784, 125785, 150126, 150127, 150128, 152323, 125795, 125796, 125797, 125798, 125799, 125800, 125801, 125802, 125803, 125804, 125805, 125806, 125807, 125814, 125815, 125816, 125817, 148991, 130013, 130014, 130015, 130016, 149014, 148997, 148998, 148999, 149000, 149001, 149002, 149003, 149004, 149005, 149006, 149007, 149008, 149009, 149010, 149011, 149012, 149013, 208815, 208816, 208817, 208818, 208819, 208820, 208821, 208822, 203416, 203394, 203395, 203396, 203397, 203398, 203399, 203400, 203401, 203402, 203403, 203404, 203405, 203406, 203407, 203408, 203409, 203410, 203411, 203412, 203413, 203414, 203415, 152368, 96940, 96941, 96942, 152366, 103111, 103110, 103109, 103108, 103107, 103106, 103105};
        turn_penalty = 6.807275539843149;
        expected = 2442.831250662295;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {62647, 62646, 62645, 62644, 62643, 62642, 62641, 62640, 62639, 62638, 67600, 130290, 130459, 130458, 70340, 70341, 70342, 70343, 70344, 70345, 70346, 70347, 70348, 70349, 70350, 70351, 142678, 142677, 142676, 142675, 142674, 142673, 149628, 149629, 149630, 149631, 149632, 149633, 149634, 149635, 149636, 149637, 149638, 149639, 149640, 149641, 149642, 149643, 149644, 149645, 149646, 149647, 149648, 219845, 219844, 219843, 219842, 219841, 219840, 219839, 219847, 219848, 219851, 132175, 132174, 132423, 132424, 132170, 132171, 132172, 132173, 148865, 148866, 165571, 165572, 150383, 150384, 150385, 150386, 150387, 150394, 150393, 146944, 146951, 146947, 195460, 146954, 165556, 146956, 79789, 79790, 148755, 148756, 148754, 150402, 150403, 127613, 221876, 129756, 129755, 129754, 129753, 129752, 129757, 129758, 129759, 147591, 147592, 147593, 129760, 147606, 147583, 147584, 147585, 147586, 163312, 78808, 77819, 128244, 128245, 163291, 147578, 163292, 163293, 177768, 177806, 177807, 177810, 177741, 177742, 128870, 128871, 151718, 151719, 151731, 151824, 167562, 151825, 127844, 127865, 150249, 164855, 127763, 127764, 127765, 127766, 165654, 147570, 147571, 147572, 164487, 150218, 164485, 164486, 105993, 154585, 58, 207548, 207549, 207550, 205505, 139016, 1162, 1163, 105906, 105905, 105904, 105903, 105902, 105901, 105900, 105899, 105898, 105897, 105896, 105895, 105894, 105893, 139304, 202080, 138932, 138931, 170941, 170940, 170939, 170938, 170937, 170936, 268, 269, 270, 271, 188001, 188002, 188003, 188004, 198653, 198654, 198655, 135469, 135468, 139762, 139764, 135474, 135149, 139760, 165322, 135166, 143077, 164919, 164923, 143205, 143126, 143125, 143133, 143130, 135520, 164915, 142194, 142201, 164902, 142198, 142203, 126531, 161857, 161858, 161865, 161866, 161867, 172935, 172930, 172931, 164899, 135294, 142522, 201905, 201906, 135293, 173427, 142577, 159153, 161869, 161870, 165186, 165187, 17552, 145635};
        turn_penalty = 24.49227607808817;
        expected = 2596.129416670023;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {96511, 96510, 96509, 98206, 98207, 203454, 167320, 167321, 147773, 99265, 167271, 167270, 167269, 167268, 167267, 167266, 167265, 97856, 97857, 97858, 97859, 129585, 129586, 129587, 147766, 149056, 149055, 149050, 125772, 125773, 125774, 125775, 125767, 125764, 125765, 125762, 125760, 151036, 125758, 125756, 164838, 125754, 125752, 125749, 105866, 105867, 105868, 105869, 105870, 105871, 105872, 148909, 148910, 148911, 148900, 65276, 65277, 65278, 151032, 151017, 133867, 133874, 133875, 133876, 133877, 133916, 133917, 133920, 133921, 128959, 128960, 128961, 150971, 128737, 165571, 165572, 150383, 150384, 150385, 150386, 150387, 150394, 150393, 146944, 146951, 146947, 195460, 146954, 165556, 146956, 79789, 79790, 148755, 148756, 148754, 150402, 150403, 165554, 147596, 147597, 161382, 147598, 147599, 161376, 161377, 137002, 137001, 136912, 136911, 136918, 136915, 136916, 136914, 136913, 136923, 127634, 136937, 136938, 136939, 136940, 136941, 136930, 164701, 136931, 136932, 136987, 136985, 136986, 136933, 136934, 136935, 136936, 127636, 127637, 158991, 158992, 158993, 145964, 151030, 151031, 136958, 136959, 136955, 136956, 136271, 136266, 44949, 128426, 156434, 136280, 136278, 136279, 136289, 136293, 136283, 136233, 192986, 147389, 147390, 136358, 136357, 136356, 136350, 136368, 136367, 136365, 44538, 44539, 136372, 136371, 136375, 136376, 136374, 136370, 156344, 156345, 156346, 156347, 156348, 156349, 156350, 136180, 136174, 136175, 136200, 136202, 146708, 128723, 164190, 128722, 147395, 147394, 164694, 136184, 136185, 136186, 136122, 136123, 140451, 199463, 141054, 140463, 159137, 140461, 140475, 164592, 132701, 146814, 140490, 164624, 132702, 132703, 132704, 132705, 171805, 171809, 171810, 141762, 141763, 137628, 134412, 134413, 134414, 141753, 141752, 171804, 171812, 171813, 141490, 141491, 141492, 137968, 137965, 137966, 11265, 194423, 182851, 137449, 137448, 137447, 137446, 137445, 137444, 137450, 140830, 192435, 192434, 192433, 173281, 173280, 173279, 173278, 173277, 173002, 173139, 173138, 173137, 173136, 173135, 173134, 11224, 12799, 12798};
        turn_penalty = 19.45167864269119;
        expected = 2660.813967809935;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {152455, 152456, 152457, 152458, 152459, 152460, 152461, 152462, 152463, 152464, 152465, 152466, 152467, 152468, 152469, 152470, 152471, 152472, 152473, 152474, 152475, 152476, 152477, 152478, 152479, 152480, 152481, 152482, 152483, 163419, 163420, 163421, 163422, 163423, 163424, 163425, 163426, 203417, 203418, 203419, 203420, 203421, 203422, 203423, 203424, 203425, 203426, 203427, 203428, 203429, 203430, 203431, 203432, 203433, 203434, 203435, 203436, 203437, 203438, 203439, 203440, 163408, 163409, 163410, 163411, 163412, 149015, 149016, 149017, 148996, 148992, 125787, 125754, 125752, 125749, 105866, 105867, 105868, 105869, 150899, 171681, 150896, 128526, 150900, 150878, 168895, 168897, 168894, 168899, 168900, 168901, 168902, 165595, 128609, 157601, 157603, 157602, 157596, 157604, 157605, 157597, 165591, 141379, 141380, 165584, 165586, 165593, 161379, 161380, 171158, 85565, 171166, 134960, 151034, 64385, 105837, 128612, 128613, 128614, 128625, 160986, 128636, 128637, 160923, 205485, 127810, 128632, 128633, 128642, 160929, 160930, 160931, 128065, 128066, 128072, 128073, 128074, 127767, 205497, 127768, 127769, 127770, 147570, 147571, 147572, 164487, 150218, 164485, 164486, 105993, 154585, 58, 138216, 138208, 138209, 138210, 138211, 138212, 162078, 162079, 162080, 162081, 162082, 190109, 176753, 176737, 139867, 190085, 190086, 106020, 106018, 105911, 141299, 141300, 132554, 132560, 132561, 132562, 132564, 132565, 132585, 132577, 132578, 132586, 132587, 132604, 132740, 132741, 132742, 139322, 139323, 132609, 132610, 132611, 132612, 132613, 132958, 132959, 132960, 132644, 132639, 132640, 132643, 132641, 132642, 132657, 132658, 132659, 36, 132674, 139556, 139553, 139554, 139550, 126758, 126761, 159062, 161417, 161435, 150524, 165974, 165973, 137733, 137732, 150518, 150519, 150520};
        turn_penalty = 34.77809088384424;
        expected = 2690.662980320627;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {175337, 120159, 120158, 120157, 120156, 120155, 120154, 120153, 120152, 120151, 209767, 209766, 209765, 180660, 180661, 209764, 122506, 120725, 120726, 120727, 120728, 120729, 120719, 120720, 120721, 120722, 120723, 167803, 167802, 167801, 182351, 182340, 182339, 182338, 182337, 139895, 139894, 139893, 139892, 139891, 139890, 139889, 139888, 139887, 139886, 139885, 139884, 139883, 139882, 139881, 172784, 172785, 172786, 172787, 172788, 172789, 172790, 172791, 172792, 172793, 172794, 172795, 17575, 17576, 135618, 135619, 135620, 135623, 135624, 135625, 135626, 135627, 135628, 161711, 135667, 135668, 135669, 135670, 161714, 134638, 134639, 134640, 134641, 134642, 134643, 134644, 135935, 135936, 135937, 135938, 142401, 136900, 136901, 165314, 142406, 142409, 142410, 165316, 142306, 142307, 142312, 142310, 142311, 142321, 136902, 142341, 142340, 142368, 142359, 142378, 142380, 165304, 165305, 165320, 142245, 142244, 142250, 142251, 142220, 142221, 142189, 142188, 135518, 142178, 142170, 142162, 142163, 161434, 142150, 142151, 126695, 165312, 165313, 105750, 139983, 118, 2790, 1466, 163510, 163511, 163512, 163513, 163514, 190089, 190090, 190091, 190092, 190093, 190094, 169312, 169313, 169314, 169315, 169316, 169317, 169318, 169319, 163496, 163497, 163498, 163499, 163500, 163501, 163502, 163503, 163504, 163505, 163506, 163507, 163508, 163509, 176856, 2505, 2504, 2503, 2502, 2501, 2500, 2499, 2498, 1708, 1709, 1710, 1711, 1712, 1713, 1714, 1715, 125839, 125840, 138553, 138554, 138555, 138556, 138557, 138558, 74, 106082, 141030, 154586, 44376, 164484, 150220, 150221, 150222, 150243, 150256, 127843, 164856, 150250, 160867, 160866, 151828, 151826, 151827, 167561, 150252, 147372, 147373, 147374, 147375, 147376, 129163, 147385, 147635, 147636, 147637, 147638, 147640, 147639, 147641, 147642, 147643, 147644, 147645, 147646, 147715, 147647, 134930, 134931, 207312, 129159, 62182, 127991, 127992, 206957, 150083, 161383, 165590, 165582, 165588, 165592, 128608, 165596, 165597, 165589, 157600, 157589, 157599, 157598, 157592, 157591, 157590, 165580, 44625, 44626, 44627, 44628, 44629, 168898, 168888, 168903, 168889, 150880, 150879, 128517, 172130, 172120, 128518, 128519, 128512, 128513, 128514, 128515, 44624, 172142, 172123, 172134, 172135, 172136, 172137, 172138, 157414, 44622, 220025, 220026, 220027, 128489, 128490, 44631, 44613, 105815, 105816, 152508, 105814, 149865, 149866, 149867, 149868, 149869, 149870, 149871, 222039, 222040, 222055, 222050};
        turn_penalty = 7.376508321948641;
        expected = 2694.657126743268;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {192374, 192375, 141519, 160889, 141520, 141528, 141530, 141517, 141529, 219658, 141518, 141527, 44691, 141477, 141489, 44647, 141486, 141487, 11335, 141496, 141497, 171806, 171811, 141751, 141754, 141755, 134415, 137626, 141773, 141767, 141768, 141769, 171807, 171808, 44431, 44432, 132706, 164623, 140489, 132700, 44590, 164590, 140476, 140446, 159123, 140456, 141053, 146812, 128461, 128462, 136116, 136119, 136105, 136106, 147391, 164716, 224881, 224882, 159138, 128432, 128433, 136427, 136381, 136382, 136405, 136407, 136945, 136946, 136947, 128440, 44924, 136024, 136025, 136019, 136013, 50965, 50966, 136249, 136203, 136204, 127635, 136957, 136951, 136960, 136961, 136962, 136963, 136965, 136966, 136967, 136968, 158994, 158995, 158996, 158997, 158998, 136988, 136989, 136995, 136994, 136991, 171846, 136992, 136990, 136980, 136981, 136982, 136983, 136984, 128324, 136922, 136921, 136920, 136919, 136928, 136929, 136927, 136926, 136925, 136924, 145924, 145925, 136797, 136798, 136850, 161617, 161608, 136862, 164709, 146813, 136874, 136875, 150682, 134941, 134947, 171171, 161345, 161347, 171157, 134965, 147163, 147164, 147165, 165585, 161383, 150065, 150066, 207405, 134912, 134915, 134914, 223051, 150213, 150214, 150215, 150216, 150212, 127999, 72160, 134878, 134877, 141383, 150121, 164191, 150139, 150138, 125784, 125785, 150126, 150127, 150128, 152323, 125795, 125796, 125797, 125798, 125799, 125800, 125801, 125802, 125803, 125804, 125805, 125806, 125807, 125814, 125815, 125816, 125817, 148991, 130013, 130014, 130015, 130016, 149014, 148997, 148998, 148999, 149000, 149001, 149002, 149003, 149004, 149005, 149006, 149007, 149008, 149009, 149010, 149011, 149012, 149013, 208815, 208816, 208817, 208818, 208819, 208820, 208821, 208822, 203416, 203394, 203395, 203396, 203397, 203398, 203399, 203400, 203401, 203402, 203403, 203404, 203405, 203406, 203407, 203408, 203409, 203410, 203411, 203412, 203413, 203414, 203415, 152368, 96940, 96941, 96942, 96943, 96944, 96945, 96946, 96947, 96948, 96949, 96950, 96951, 96952, 96953, 96954, 96955, 96956, 96957, 98319, 98318, 98317, 98316, 98315, 98314, 98313, 98312, 98311, 98310, 99579, 99578, 99577};
        turn_penalty = 31.4100801993517;
        expected = 2705.034770849203;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {89035, 89036, 89037, 89038, 92321, 92322, 92323, 92324, 92325, 92326, 92327, 92328, 92329, 92330, 92331, 92332, 128894, 128898, 128899, 198662, 198664, 198667, 139187, 139188, 139189, 139190, 139202, 139203, 139204, 139205, 139206, 139207, 139208, 139209, 139222, 139211, 139220, 139221, 163359, 163360, 163361, 163362, 163363, 148325, 148323, 148324, 148119, 148120, 148121, 148122, 146911, 146900, 146901, 218128, 218127, 146924, 146925, 146926, 146930, 146914, 146915, 146916, 146932, 146934, 146935, 131322, 131323, 131318, 131319, 131320, 131321, 138023, 138024, 128373, 128374, 128375, 128376, 127623, 148086, 148087, 163374, 163375, 163376, 127855, 127964, 127965, 163314, 163315, 163352, 149367, 149368, 149369, 128162, 128163, 149358, 149357, 161384, 128158, 128311, 128312, 161428, 127918, 195548, 128081, 128082, 44373, 164877, 105883, 44372, 151058, 76, 140145, 140146, 140053, 140054, 140055, 140056, 140057, 140058, 140217, 2602, 2603, 2604, 2605, 2606, 2607, 139975, 139967, 139966, 139648, 139645, 2185, 139992, 139997, 40, 139996, 105751, 165317, 165318, 161396, 142009, 142148, 142149, 142169, 142168, 142179, 135144, 142187, 142197, 142219, 165634, 142249, 165308, 142252, 142253, 165306, 142381, 142377, 165309, 142360, 142361, 142344, 142342, 142343, 136903, 142336, 142309, 142308, 165307, 142302, 142303, 142304, 142305, 142408, 142407, 165319, 136904, 136905, 142402, 142403, 136906, 136893, 136894, 136895, 136896, 136897, 136898, 136899, 135684, 161721, 161722, 32587, 172822, 172823, 24997, 24998, 24999, 25000, 25001, 25002, 25003, 18853, 18854, 24993, 24994, 24995, 24996, 138740, 184547, 184548, 184549, 184550, 184551, 194938, 194939, 194940, 194941, 194942, 194943, 194944, 194945, 194946, 194947, 194948, 194949, 194950, 194951, 194952, 194953, 194954, 194955, 194956, 194957, 194958, 159424, 159425, 159426, 159427, 159428, 159429, 159430, 159431, 159432, 159433, 159434, 159435, 159436, 159437, 159438, 159439, 159440, 159441, 159442, 159443, 159444, 181712, 181711, 131921, 219913, 219912, 219911, 219910, 219909, 219908, 219907, 219906, 219905, 219904, 219903, 219902, 219901, 114350, 114351, 219914, 194978, 194977, 194976, 121803, 121802, 121994, 121995};
        turn_penalty = 20.94736646101775;
        expected = 2726.016014480137;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
    } //path_cost_new_york_usa

} //path_cost_new_york_usa_public

