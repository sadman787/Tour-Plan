#include <random>
#include <iostream>
#include <unittest++/UnitTest++.h>

#include "StreetsDatabaseAPI.h"
#include "m1.h"
#include "m3.h"
#include "m4.h"

#include "unit_test_util.h"
#include "courier_verify.h"

using ece297test::relative_error;
using ece297test::courier_path_is_legal;


SUITE(path_cost_london_england_public) {
    TEST(path_cost_london_england) {
        std::vector<unsigned> path;
        double turn_penalty;
        double expected;
        double actual;
        
        path = {6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 3068, 3067, 3066, 12053, 180464, 177872, 177873, 390735, 390736, 390737, 300336, 467480, 467481, 467482, 467483, 467484, 467485, 467486, 467487, 482465, 482466, 101370, 2345, 243412, 243413, 243414, 300526, 300528, 375697, 341027, 341028, 341029, 454758, 112484, 112489, 36149, 108700, 108701, 108702, 108703, 375691, 341025, 32850, 450873, 450871, 450872, 481971, 464156, 431729, 75, 76, 512424, 486706, 109351, 3790, 3789, 3788, 32804, 32805, 32806, 32740, 32741, 32742, 32743, 32698, 32699, 32700, 32701, 32670, 32671, 32672, 32673, 32679};
        turn_penalty = 0;
        expected = 598.5780734546579;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {34166, 160393, 160394, 480888, 506382, 1009, 480900, 1010, 1011, 1012, 1013, 1014, 1015, 1016, 375867, 480892, 36313, 160413, 160411, 160412, 3251, 109276, 109277, 109278, 109279, 375723, 302210, 302211, 302212, 2254, 2255, 2256, 479818, 479825, 3254, 281614, 281615, 246526, 246527, 6371, 347061, 436077, 184627, 184626, 184805, 184806, 184807, 159730, 159729, 289549, 289550, 289551, 389373, 389370, 184809, 257385, 257381, 355648, 355649, 8469, 9031, 9032, 9033, 9034, 356359, 356360, 159747, 159748, 159749, 397359, 205475, 166420, 260080, 482973, 482982, 482972, 482974, 482969, 482968, 482983};
        turn_penalty = 1.917191447300373;
        expected = 777.1016741023708;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {36019, 36018, 36017, 36086, 36083, 466661, 362986, 362987, 454675, 271118, 271117, 496499, 496498, 36090, 36082, 36081, 36080, 239212, 239213, 496501, 496502, 229355, 229356, 229357, 46841, 46842, 46839, 46840, 229344, 495294, 72849, 355925, 46061, 457315, 46063, 46062, 188149, 64233, 457319, 457320, 457321, 457322, 309160, 309161, 309153, 309154, 309155, 309156, 309157, 309158, 309159, 188144, 188145, 173072, 173073, 173074, 173075, 347635, 347637, 347636, 178317, 178316, 178315, 178314, 178313, 173093, 173094, 173095, 343464, 72823, 436701, 304722, 304725, 21170, 21171, 21172, 448487, 16897, 448547, 448556, 442893, 448552, 448549, 143996, 143997, 143993, 143994, 448558, 448554, 143959, 143958, 78436, 78435, 255352, 255353, 78562, 520649, 78565, 25546, 25547, 77422, 371255, 520651, 520652, 520653, 520654, 520655, 25542, 489196, 25545, 276061, 276060, 276059, 276058, 276057, 276056, 276055, 276054, 276065, 276064, 276063, 276062, 25539, 77406, 77405, 77404};
        turn_penalty = 17.54021232368054;
        expected = 1909.429402725301;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {442474, 196639, 196638, 309627, 309628, 309629, 309630, 30063, 30064, 30065, 474320, 474321, 474322, 474323, 474324, 474325, 474326, 281433, 281431, 281432, 264974, 264975, 245199, 367770, 309617, 309618, 367506, 367504, 477558, 410880, 6615, 6616, 6617, 6618, 6619, 410866, 410867, 410868, 281337, 451345, 410871, 7622, 7623, 65943, 408851, 5507, 380961, 380960, 408894, 408895, 272882, 436652, 275751, 275752, 380955, 380958, 451246, 451251, 65877, 65876, 436656, 5505, 5506, 5504, 380942, 380951, 380954, 380946, 3804, 3805, 380953, 380945, 336931, 336932, 436641, 291946, 291947, 291948, 65944, 451247, 1340, 450212, 338144, 284903, 284904, 338140, 715, 171452, 171451, 171462, 171463, 171464, 171465, 281826, 281827, 476019, 452102, 286971, 206723, 422902, 459899, 459900, 459901, 450188, 218943, 218944, 218945, 264838, 264842, 264843, 264850, 264849, 459896, 459893, 382302, 382303, 382296, 382300, 382301, 191213, 191214, 12777, 12778, 12779, 12780, 184827, 184815, 13997, 13998, 13999, 184828, 184829, 86011, 86010, 85941, 535688};
        turn_penalty = 7.376508321948641;
        expected = 1967.462956908666;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {416737, 416736, 416735, 416734, 416733, 416732, 416731, 416730, 160339, 160343, 160344, 27405, 27406, 496999, 497000, 480893, 480894, 480895, 506385, 506386, 506387, 506388, 506389, 351619, 187507, 187508, 187509, 187510, 187511, 187512, 34165, 34166, 160393, 160394, 480888, 506382, 1009, 480900, 1010, 1011, 1012, 1013, 1014, 1015, 1016, 375867, 480892, 480897, 480896, 1082, 1083, 1084, 1085, 1086, 358247, 358248, 358249, 358250, 479795, 479801, 479796, 479797, 479798, 1089, 1090, 1091, 465137, 465138, 465139, 3618, 159927, 159929, 245710, 387754, 356448, 387759, 387760, 387879, 272860, 397147, 460154, 418038, 397131, 506657, 506777, 506663, 397132, 397133, 397137, 397136, 397135, 397134, 396876, 506660, 506659, 159856, 272853, 506425, 506405, 88120, 88126, 88127, 88145, 506420, 272856, 88146, 23641, 272854, 506408, 26416, 4670, 397145, 397143, 64252, 64251, 506422, 3858, 506423, 386315, 178686, 178687, 178688, 178689, 178683, 178679, 178680, 178681, 396893, 396894, 396895, 396896, 396897, 10254, 10255, 10256, 51216, 51217, 23883, 13973, 9331, 449748, 449749, 9332, 9333, 9334, 9335, 9336, 9338, 9387, 9386, 9385, 9384, 9383, 9382, 9381, 9380, 9379, 9378, 9377, 9376, 9375, 9374, 9319, 9320, 9321, 51054, 51055, 24986, 24985, 24984, 24982, 319165, 319150, 319151, 24981, 387336, 387338, 387337, 23650, 23643, 387374, 23644, 23645, 23646, 23647, 23648, 23649, 302449, 25103, 25104, 25105, 25106, 25107, 302450, 387317, 279048, 279047, 279046, 279045, 279044, 279043, 279054, 279053, 279052, 279051, 279050, 279049, 303172, 303171, 303170, 303169, 254028, 254027, 254026, 382249, 382248, 68979, 68980};
        turn_penalty = 1.678496132715128;
        expected = 2113.710668065055;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {78626, 462288, 462287, 322623, 18362, 467939, 199233, 525546, 525547, 467934, 467931, 389231, 465770, 465771, 445451, 73960, 73959, 73958, 73957, 73956, 73955, 73954, 73953, 73952, 73951, 73950, 73949, 73948, 73947, 73946, 73945, 73944, 73943, 73942, 73941, 73940, 73939, 73938, 73937, 73936, 73935, 73934, 73933, 73932, 73931, 73930, 73929, 73928, 73927, 120111, 120112, 89770, 89769, 89768, 89767, 89766, 89765, 89764, 86310, 195964, 195965, 316311, 466118, 466123, 466120, 466121, 466122, 339060, 522174, 195968, 195967, 195966, 192265, 192266, 192267, 192268, 497390, 497391, 497392, 502590, 502589, 541677, 541676, 541675, 541674, 541679, 541678, 502602, 502601, 502600, 502599, 502598, 502597, 502596, 502595, 21648, 541682, 195971, 195972, 195976, 449447, 449446, 449445, 449444, 449443, 449442, 449441, 449440, 449439, 449438, 449437, 132444, 535273, 470221, 465525, 389413, 389414, 316462, 449450, 116938, 449690, 288199, 288200, 288201, 449940, 484404, 465174, 252674, 257782, 438471, 285796, 532836, 532837, 257819, 459031, 526881, 323755, 323759, 257846, 521430, 329838, 516481, 516480, 516479, 516478, 516477, 163956, 163955, 163954, 163953, 163952, 163957, 465975, 163951, 471964, 289476, 532743, 532744, 271054, 470539, 17246, 470540, 470541, 17245, 335625, 367626, 490467, 494193, 494195, 494194, 468542, 468541, 468540, 17243, 57511, 57512, 283611, 283612, 489563, 157431, 157430, 157424, 157423, 486539, 342329, 486540, 486541, 486542, 486533, 486534, 486535, 484491, 486537, 138438, 316274, 29127, 460763, 460764, 460765, 460766, 496464, 29652, 485798, 485799, 485800, 484694, 412217, 412218, 29506, 29507, 29508, 29509, 29510, 29511, 484698, 484699, 484700, 484695, 484696, 465013, 484711, 484712, 484697, 3715, 470531, 470532, 470533, 470534, 470535, 459633, 511472, 511473, 511474, 511475, 511476, 511477, 511468, 511469, 511470, 511471, 3717, 3718, 3719, 3720, 3721, 3722, 3723, 3724, 3725, 3726, 3727, 3728, 277197, 277198, 100704, 476592, 100707, 288518, 288517, 3686, 3685, 3684, 3675, 3676, 218198, 218199, 218200, 218201, 342331, 218204, 218205, 512764, 471301, 512765, 3660, 299865, 512762, 301860, 512763, 512842, 512769, 299500, 512827, 512837, 512833, 512831, 512828, 512838, 512839, 489799, 376019, 489798, 376025, 376024, 376018, 376017, 376016, 376021, 376020, 376023, 376022, 513073, 513070, 513078, 513079, 513065, 513066, 513067, 513068, 513069, 512965, 512964, 193846, 1032, 1033, 512989, 512984, 512985, 512986, 512987, 534258, 297529, 297530, 297531, 297532, 335626, 376015, 148238, 148237, 249361, 480883, 335627, 335628, 335629, 335630, 1004, 1005, 1006, 300343, 300344, 300345, 300346, 496998, 160356, 160355, 480893, 480894, 480895, 506385, 506386, 506387, 506388, 506389, 351619, 187507, 187508, 187509, 187510, 187511, 187512, 34165, 34166, 160393, 160394, 480888, 506382, 1009, 480900, 1010, 1011, 1012, 1013, 1014, 1015, 1016, 375867, 480892, 480897, 480896, 1082, 1083, 1084, 1085, 1086, 358247, 358248, 358249, 358250, 479795, 479801, 479796, 479797, 479798, 479799, 479800, 82014, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 446235, 446236, 446237, 446238, 446239, 446240, 446241, 446242, 446243, 446244, 446245, 446246, 446247, 446248, 446249, 446250, 446251, 446252, 446253, 446254, 446255, 446256, 446257, 446258, 446259, 108818, 108819, 378143, 378144, 378145, 378146, 407, 408, 409, 289794, 289795, 289796, 4983, 196140, 8918, 8919, 8920, 289737, 289738, 289739, 289740, 292970, 292971, 108725, 108724, 108723};
        turn_penalty = 4.316860293722849;
        expected = 2331.83339975627;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {65004, 493136, 493135, 493134, 493133, 493132, 493131, 493130, 493129, 65219, 449738, 472630, 315656, 315655, 315654, 283927, 283928, 516366, 516367, 516368, 516365, 477174, 477175, 513473, 513472, 543978, 543977, 543976, 543975, 283933, 366573, 167540, 167541, 167539, 518276, 18054, 54691, 54692, 54693, 54694, 54695, 54696, 246516, 246517, 246518, 246519, 246520, 246506, 246507, 246508, 50172, 50171, 50170, 50169, 50168, 50167, 283922, 283921, 283920, 283919, 283918, 283917, 480094, 480093, 17633, 110412, 465312, 465313, 465314, 465315, 465316, 465317, 465318, 465319, 465320, 465321, 465322, 465323, 465324, 17632, 17631, 17630, 366302, 366301, 17616, 17615, 17614, 17613, 17612, 17611, 181704, 181705, 181706, 181707, 181709, 406351, 381338, 381339, 381340, 32845, 32846, 32847, 32848, 291145, 111250, 111251, 111252, 111253, 111254, 111255, 222298, 111256, 160101, 160100, 160099, 160098, 160097, 543123, 320707, 320708, 320709, 320710, 320711, 489795, 489794, 489793, 489791, 217675, 217674, 489789, 489788, 489787, 489786, 489785, 489784, 320720, 18634, 18635, 18636, 18637, 18638, 256703, 256702, 256701, 256700, 279188, 33438, 33437, 33436, 33435, 33434, 33433, 90468, 90467, 313540, 301869, 52730, 52731, 52732, 256704, 256705, 256706, 256707, 256708, 256709, 256710, 399780, 399781, 399782, 399783, 484516, 484517, 484513, 494205, 494206, 472353, 494207, 494208, 494209, 302205, 302206, 302207, 302208, 279189, 321880, 321881, 321882, 321883, 321884, 315480, 315481, 315482, 315483, 315484, 315485, 315486, 315487, 315488, 315489, 315490, 442979, 442978, 11782, 11783, 11784, 350364, 350365, 350366, 350367, 350368, 350369, 350370, 350371, 350372, 350373, 350374, 350375, 11785, 11786, 11787, 11788, 11789, 11790, 11791, 532672, 532673, 532674, 297500, 297496, 297497, 297498, 297499, 532747, 532748, 532749, 532750, 11781, 532742, 302675, 302676, 302677, 284776, 266565, 266566, 266567, 302146, 302147, 4940, 95789, 300562, 519241, 519242, 479895, 3733, 479898, 479897, 6438, 6439, 300510, 95817, 160314, 160313, 160359, 160378, 160380, 160381, 356295, 356294, 160396, 160397, 258782, 476868, 132103, 325863, 325864, 325859, 325856, 325855, 47664, 160415, 47639, 47640, 47641, 47642, 47643, 47644, 1086, 358247, 358248, 358249, 358250, 479795, 479801, 479796, 479797, 479798, 479799, 479800, 82014, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 446235, 446236, 446237, 446238, 446239, 446240, 446241, 446242, 446243, 446244, 446245, 446246, 446247, 446248, 446249, 446250, 446251, 446252, 446253, 446254, 446255, 446256, 446257, 446258, 446259, 108818, 108819, 378143, 378144, 378145, 378146, 407, 408, 409, 289794, 289795, 289796, 292961, 292962, 292963, 292964, 292965, 292966, 292967, 453318, 453319, 453320, 453321, 194862, 108713, 108712, 108709, 108710, 108711, 289733, 289734, 289735, 289736, 110, 111, 112, 113, 114, 115, 116, 117, 890, 891, 892, 282397, 282398, 512661, 282477, 282478, 541179, 512656, 512657, 512658, 512659, 512660, 1502, 1503, 1504, 406302, 406301};
        turn_penalty = 13.2311767140731;
        expected = 2460.664122553384;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {518573, 518572, 154227, 154226, 154225, 307802, 70849, 70850, 70851, 452504, 367784, 266294, 72255, 72256, 350174, 350175, 350178, 21325, 21326, 21327, 21328, 259417, 259416, 251167, 251168, 251169, 251170, 251171, 251172, 281317, 281318, 281310, 281311, 481100, 64193, 64192, 64191, 64190, 64189, 64188, 64187, 481119, 64186, 298251, 298250, 298249, 298248, 361052, 538952, 538951, 538950, 273078, 273077, 273076, 515931, 515930, 515929, 515928, 515927, 515926, 515925, 515924, 515923, 515922, 515921, 515920, 515919, 515918, 515917, 515916, 515915, 515934, 515914, 515912, 515939, 515940, 515938, 515937, 515760, 465849, 515757, 515756, 30709, 369181, 476041, 476042, 476043, 476044, 476045, 515764, 2320, 2321, 2322, 515752, 515753, 515754, 479199, 479197, 479198, 515398, 515402, 515397, 515401, 515406, 515407, 515400, 515408, 69918, 298180, 298181, 515352, 507553, 507554, 237171, 237172, 515349, 515350, 515346, 515347, 515348, 515337, 515338, 515339, 58359, 515333, 479201, 515354, 264941, 264942, 515355, 2115, 2116, 2117, 2118, 375294, 375295, 375296, 375297, 335633, 448296, 335632, 477333, 266778, 525462, 397354, 203478, 203479, 266776, 266777, 397335, 397325, 397336, 491938, 397337, 397331, 397326, 397327, 1336, 376110, 376108, 376122, 452103, 281828, 716, 717, 718, 171461, 171460, 171450, 171453, 452097, 452101, 452098, 452100, 146442, 146445, 354696, 286974, 452094, 452092, 338159, 172365, 393244, 393240, 517786, 517777, 517770, 517780, 517764, 517763, 393243, 416686, 411401, 384900, 498793, 440943, 498794, 498798, 498792, 498802, 288731, 288732, 288733, 288734, 109449, 498783, 498784, 498785, 440931, 467676, 467659, 433864, 433865, 64334, 64335, 64336, 64337, 380227, 380229, 380230, 380269, 380268, 380267, 380261, 380262, 380263, 380264, 380265, 433850, 434264, 434265, 434266, 434267, 434268, 434269, 440934, 440935, 440936, 440937, 536183, 536182, 440953, 536522, 536521, 536520, 536519, 536171, 536170, 536169, 536168, 440951, 466586, 516327, 516326, 405980, 453731, 453730, 453729, 453728, 453727, 453726, 453725, 453724, 453723, 453722, 453721, 459398, 459397, 459396, 380492, 380493, 380489, 405996, 405995, 405994, 405993, 405992, 405991, 405990, 405989, 405988, 380494, 380495, 414549, 414550, 414551};
        turn_penalty = 30.26936737054029;
        expected = 2698.797303037259;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {434342, 492662, 434341, 434321, 434322, 267464, 42158, 42151, 42150, 42155, 42160, 389644, 16757, 42138, 42139, 42133, 389642, 16755, 16754, 16753, 16752, 16751, 40144, 16744, 40143, 35568, 35569, 304835, 389645, 389646, 306330, 304845, 448598, 40126, 35559, 35560, 35561, 40131, 38817, 38818, 40134, 38811, 38812, 38813, 40896, 40898, 40899, 304894, 490505, 40890, 40885, 40886, 40887, 40892, 40900, 40901, 308336, 308337, 463199, 463200, 176729, 176730, 323084, 488113, 488114, 40903, 40904, 393419, 393420, 393421, 393422, 393423, 393424, 393425, 393426, 393427, 393428, 393429, 393430, 393431, 393432, 393433, 393434, 493662, 493661, 493660, 493665, 158232, 487245, 487244, 487243, 502686, 502685, 502684, 419656, 419662, 158217, 158216, 158215, 317663, 317662, 540454, 158212, 158211, 487242, 487241, 158209, 158208, 158207, 158206, 158205, 487233, 158195, 158194, 158193, 158192, 158191, 419542, 419541, 419543, 487255, 158181, 158180, 158179, 487235, 487234, 158171, 494909, 494908, 494907, 494906, 158168, 158167, 158166, 158165, 419540, 444703, 304901, 304903, 304902, 494895, 494894, 494893, 494905, 494904, 494903, 494902, 494901, 494900, 494899, 494898, 494897, 494896, 306820, 306819, 306818, 293829, 293828, 293827, 293826, 293825, 293824, 293823, 293822, 485439, 485438, 485437, 485436, 294662, 294661, 489434, 489433, 489432, 489431, 489430, 489429, 489428, 358594, 358593, 358592, 358591, 341825, 341824, 341823, 341822, 341821, 341820, 341819, 341818, 341817, 341816, 341815, 300150, 341803, 341804, 341805, 423320, 281607, 395110, 395111, 395112, 395113, 395114, 295281};
        turn_penalty = 43.26898993091054;
        expected = 2805.620790506417;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {255587, 455698, 455697, 465211, 3448, 262290, 262288, 465026, 360158, 253384, 253385, 465061, 465062, 442688, 465252, 465237, 465221, 383407, 83105, 488883, 465034, 262286, 486504, 486505, 465036, 465038, 465037, 315414, 465124, 465125, 301840, 485840, 485839, 298749, 298747, 298748, 493851, 493850, 493849, 493848, 493847, 493852, 493853, 493845, 493844, 493843, 82937, 43534, 493846, 262135, 367938, 481742, 481743, 357307, 262136, 493857, 493856, 493855, 266851, 266850, 266849, 266848, 266847, 266846, 266845, 266844, 482422, 482389, 482380, 482388, 482418, 482414, 482415, 482416, 482387, 482412, 482390, 537057, 482408, 482409, 482410, 162724, 488079, 545823, 483989, 488081, 313169, 313168, 313167, 313166, 313165, 313164, 313163, 313162, 480298, 54375, 54374, 54373, 313173, 313172, 293779, 293778, 488078, 488077, 488076, 488075, 488074, 488073, 54368, 488072, 488071, 488070, 488069, 488068, 488067, 417508, 466459, 466460, 417545, 417548, 417501, 416340, 15851, 15852, 351944, 30858, 30859, 494315, 373440, 373441, 373442, 459049, 545194, 319674, 319675, 319676, 387908, 387895, 387896, 387897, 387909, 387910, 387911, 387912, 387893, 387894, 190656, 199149, 190655, 387888, 387884, 387883, 194865, 521827, 288786, 532826, 521830, 521831, 352046, 543495, 543496, 352053, 543497, 352045, 287011, 543498, 387994, 387995, 449307, 542269, 350084, 473850, 473851, 502724, 472255, 514146, 514147, 514145, 183479, 283383, 282348, 30212, 183477, 502738, 502739, 387120, 387119, 291134, 291133, 291132, 416342, 416341, 501351, 291127, 45042, 291129, 291128, 291131, 291130, 397208, 397207, 461509, 453503, 57511, 57512, 17088, 17089, 489559, 489560, 450223, 450224, 86408, 17091, 7637, 7638, 418341, 449508, 515286, 460823, 460822, 460821, 460820, 460819, 460829, 460828, 460827, 460826, 460825, 460824, 460831, 460830, 460835, 460834, 460833, 544861, 544860, 18757, 460832, 537370, 537369, 537371, 460838, 460837, 460836, 330384, 18756, 474720, 474722, 94549, 94548, 94547, 94546, 366302, 366301, 17616, 17615, 17614, 17613, 17612, 17611, 255584, 255583, 255582, 255581, 382938, 382937, 382936, 382932, 382939, 382935, 370156, 370157, 370158, 337913, 337914, 279197, 279196, 279195, 486007, 486006, 486005, 486004, 486003, 486002, 486001, 486000, 485999, 485998, 280644, 280645, 323452, 314321, 314320, 418078, 302629, 302628, 302627, 302626, 302625, 330632, 330631, 330630, 330629, 330628, 327756, 327755, 327754, 327753, 327750, 192114, 192113, 17610, 519674, 273400, 494538, 519665, 266731, 97311, 494540, 519690, 310492, 273389, 519691, 519692, 494539, 374602, 101078, 513484, 101079, 101081, 511351, 511347, 325923, 511346, 348041, 519670, 101087, 511343, 511340, 511342, 511341, 511344, 301590, 301589, 301588, 14675, 14674, 14673, 14672, 14671, 14670, 266728, 289919, 289918, 289917, 289916, 289915, 289914, 289913, 258380, 14669, 14668, 14667, 14666, 14665, 538465, 538466, 16895, 16894, 16893, 273368, 273367, 273366, 273365, 273364, 273363, 68104, 68103, 68102, 68058, 68059, 68056, 541735, 68060, 68061, 68062, 68063, 68064, 68065, 68066, 68067, 68068, 68069, 301522, 387748, 534666, 534667, 534668, 534669, 534670, 534671, 534672, 534673, 536535, 377107, 377108, 377109, 377110, 274612, 274613, 274614, 274601, 274602, 274603, 274604, 274605, 274606, 274607, 274608, 274609, 274610, 274611, 274332, 274331, 18641, 18642, 303037, 18640, 18639, 68710, 353057, 353588, 353587, 353179, 353170, 353181, 353175, 353168, 541126, 541160, 418011, 479958, 479957, 354606, 354605, 354603, 541129, 301574, 415452, 354609, 354608, 354607, 418010, 541161, 391869, 391870, 391871, 284400, 284401, 284402, 541158, 460976, 460977, 541732, 541733, 531460, 479884, 303153, 102880, 264165, 3122, 377098, 284387, 408621, 284389, 284390, 284391, 284392, 453598, 167245, 167246, 167247, 413282, 285890, 415463, 285896, 465667, 465668, 465669, 152358, 394353, 152356, 152357, 269654, 394351, 269653, 458103, 393236, 450204, 450205, 414952, 499535, 376362, 257305, 257306, 393099, 393100, 251591, 410271, 459855, 253550, 253549, 253555, 253554, 459852, 459853, 1325, 1326, 1327, 1328, 1318, 1319, 1320, 1321, 416610, 416612, 416613, 416614, 416609, 416615, 416616, 416617, 526293, 526294, 526295, 416604, 526290, 416608, 416607, 416603, 416602, 416601, 416600, 416599, 416598, 416597, 660, 659, 658, 657, 429430, 429429, 429428, 429427, 429426, 429451, 429492, 429463, 429464, 429465, 429466, 429467, 429456, 429461};
        turn_penalty = 0;
        expected = 2824.558662210133;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {32247, 32243, 110970, 205378, 205377, 109864, 109863, 109865, 445784, 493080, 493081, 493082, 493083, 493084, 493085, 493086, 493087, 493088, 31753, 205312, 205303, 205304, 205305, 205306, 205307, 205308, 205309, 205310, 205311, 445760, 507071, 507072, 507073, 445761, 445762, 449957, 110783, 110784, 110777, 110778, 507070, 511545, 387772, 387771, 387770, 387769, 387768, 446547, 387766, 387767, 9531, 9527, 108896, 387765, 153333, 478109, 153330, 382561, 153332, 159975, 330460, 478073, 478074, 121066, 478087, 478093, 478094, 478095, 478096, 478097, 9524, 9525, 436666, 143795, 143796, 438796, 437300, 387773, 34740, 143790, 387761, 387755, 387763, 387762, 141758, 238080, 542185, 143809, 143810, 542187, 143811, 1585, 292051, 453407, 435859, 143814, 542176, 143815, 280988, 280989, 57584, 185387, 57585, 57583, 185388, 185391, 542184, 57468, 57476, 387622, 57475, 387621, 57474, 57473, 356055, 356056, 57469, 53749, 542180, 327423, 57463, 57462, 57461, 542179, 57460, 387815, 57454, 57453, 542182, 53751, 1492, 1493, 304251, 304252, 304250, 304240, 304242, 304243, 304244, 357661, 357662, 176643, 219731, 304260, 304261, 22805, 250187, 512312, 421035, 164402, 164403, 512311, 421033, 421029, 421030, 421031, 250185, 328735, 446207, 292385, 488208, 488209, 488210, 488211, 292815, 292816, 292817, 292818, 292819, 292820, 359983, 312958, 312959, 292362, 292363, 488214, 488215, 488216, 520455, 520457, 520459, 359982, 520462, 520461, 292805, 520107, 520106, 520105, 520104, 520103, 520102, 520101, 520100, 520099, 520098, 292374, 292373, 292372, 34639, 34638, 71734, 71733, 71732, 71731};
        turn_penalty = 26.06136747164377;
        expected = 2885.931580199955;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {162313, 162314, 162315, 69413, 69414, 545896, 545895, 545894, 545893, 482556, 482555, 482554, 482553, 113887, 113886, 113885, 113884, 113883, 113882, 113881, 160841, 160840, 160839, 481194, 9777, 9776, 9775, 9774, 9773, 9772, 9771, 9770, 9769, 9768, 9767, 335637, 474393, 474392, 474391, 474390, 474389, 474388, 474387, 474386, 474385, 474397, 474398, 474399, 545887, 545888, 481664, 481665, 542877, 542872, 542878, 83856, 354904, 354905, 354906, 354907, 354901, 456494, 21650, 545882, 545883, 545884, 545885, 545886, 445844, 456499, 456500, 456501, 456502, 456503, 456504, 456505, 445843, 69579, 69580, 69581, 69582, 545870, 545871, 545872, 288224, 288225, 474185, 290803, 456511, 456512, 448350, 389233, 456915, 456914, 456913, 456912, 456910, 456909, 405811, 405810, 405809, 405808, 405807, 405806, 405805, 405804, 405803, 405802, 405801, 405800, 405799, 405798, 405797, 405796, 405795, 456922, 456921, 405813, 405812, 456908, 456907, 456906, 456905, 456904, 456903, 456902, 466119, 466118, 466123, 466120, 466121, 466122, 339060, 522174, 195968, 195967, 195966, 497388, 497387, 497395, 21599, 325917, 325916, 325915, 325914, 325913, 325912, 325911, 325910, 325909, 325908, 325907, 325906, 325905, 325904, 325903, 325902, 325901, 325900, 253010, 253009, 253008, 253007, 253006, 253005, 253004, 253003, 253002, 21647, 285097, 132558, 511516, 289182, 289181, 492916, 492915, 492914, 492913, 492912, 492911, 475766, 190639, 492909, 492910, 88988, 341043, 465969, 105529, 492921, 467228, 268931, 199140, 467222, 284366, 543044, 542627, 542613, 467443, 466151, 466154, 466152, 466153, 465710, 465711, 465712, 465713, 465714, 465715, 269521, 319086, 5667, 104869, 489498, 540220, 540219, 540218, 540217, 540216, 540221, 206263, 541463, 363817, 318171, 318170, 318169, 318168, 318167, 318166, 318165, 318164, 318163, 318162, 387636, 493588, 473739, 473738, 473737, 301922, 304221, 321917, 306059, 410663, 410661, 348288, 410662, 410660, 199243, 494186, 417503, 417547, 488066, 443360, 466470, 29394, 417546, 492530, 494456, 492532, 466467, 417508, 488067, 488068, 488069, 488070, 488071, 488072, 54368, 488073, 488074, 488075, 488076, 488077, 488078, 293778, 293779, 313172, 313173, 54373, 54374, 54375, 480298, 313162, 313163, 313164, 313165, 313166, 313167, 313168, 313169, 162723, 313170, 313171, 482410, 482409, 482408, 537057, 482390, 482394, 482395, 482401, 482404, 482405, 482403, 482413, 482389, 482422, 266844, 266845, 266846, 266847, 266848, 266849, 266850, 266851, 493855, 493856, 493857, 417444, 417445, 417446, 262137, 493858, 493859, 481749, 481750, 299190, 82937, 493843, 493844, 493845, 493853, 493852, 493847, 493848, 493849, 493850, 493851, 298746, 298749, 485837, 485835, 480345, 301839, 301840, 465125, 4116, 493842, 315415, 486502, 262647, 465208, 465027, 465028, 465029, 109391, 465041, 459886, 459887, 459888, 358393, 480350, 250202, 109392, 250208, 4118, 484158, 493311, 493341, 493342, 498526, 352017, 352018, 498529, 498530, 498531, 498532, 131502, 131501, 292040, 57694, 172973, 359511, 182599, 182598, 313954, 182594, 357103, 182593, 111832, 182590, 133535, 465617, 465618, 493418, 493419, 493415, 493416, 493417, 77314, 353578, 353579, 241313, 77315, 291467, 77230, 293433, 77261, 77262, 387407, 292334, 292333, 292332, 292331, 292330, 291821, 291514, 291513, 292261, 292260, 292259, 292258, 292257, 292256, 292255, 292254, 292253, 292252, 292251, 292250, 292249, 292248, 292247, 292246, 450452, 450451, 450450, 450449, 481300, 481301, 481296, 481291, 481299, 6487, 6488, 6489, 6490, 6491, 6492, 6493, 6494, 360005, 360006, 360007, 360008};
        turn_penalty = 24.49227607808817;
        expected = 2961.98540813211;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {488716, 488715, 488714, 488713, 488712, 466524, 466523, 466522, 466521, 466520, 496723, 496722, 496721, 496725, 496718, 496705, 496711, 496720, 257671, 30898, 30897, 512270, 83905, 532832, 532831, 532830, 509912, 509911, 509910, 509909, 509908, 509907, 510273, 196177, 510270, 510268, 268978, 268977, 268976, 525641, 216673, 286332, 286331, 286330, 450360, 450359, 450361, 471557, 103207, 450363, 103208, 175329, 459053, 14152, 14113, 363680, 1516, 521288, 521290, 521291, 206266, 501318, 285967, 285968, 285969, 285970, 285971, 285972, 285973, 285974, 285975, 285976, 285977, 285978, 470027, 470039, 470040, 541457, 470023, 470024, 380000, 380001, 105480, 105481, 533612, 533622, 533623, 533616, 533617, 533618, 533619, 533620, 533615, 533614, 533613, 484528, 252806, 540193, 190664, 540191, 153995, 540203, 540204, 510082, 523453, 510081, 523456, 494269, 494268, 494267, 229259, 494265, 494264, 494272, 494271, 494270, 494282, 480959, 480958, 480957, 480956, 480955, 480954, 252677, 252676, 458954, 546168, 546167, 546170, 546169, 540703, 540702, 540701, 540700, 540699, 29401, 132558, 285097, 280046, 461455, 461456, 461457, 272805, 272806, 272807, 272808, 272809, 272810, 272811, 272812, 272813, 272814, 272815, 272816, 272817, 272818, 272819, 272820, 195969, 195970, 195977, 541671, 541682, 316391, 540725, 540724, 540723, 540722, 540721, 540720, 540719, 540718, 540717, 540715, 540714, 540713, 540712, 540711, 540710, 540709, 21649, 540716, 538375, 538374, 244395, 244394, 244393, 244392, 244391, 244390, 244389, 244388, 244387, 244386, 244385, 465635, 465636, 178699, 448921, 448920, 448919, 448918, 448343, 448342, 448341, 448340, 448339, 448338, 448337, 448336, 448335, 448334, 448333, 448332, 448331, 448330, 448329, 448328, 448327, 448326, 448345, 448344, 21661, 362355, 165464, 165463, 165462, 165461, 165460, 165459, 165458, 165457, 165456, 165455, 165454, 165453, 165452, 165451, 165450, 165449, 165448, 165447, 165446, 165445, 165444, 165443, 165442, 165441, 165440, 143665, 143664, 143663, 143666, 41485, 51908, 288586, 288587, 288588, 165465, 541721, 541720, 541719, 541718, 541717, 541716, 541726, 541725, 541724, 541723, 541722, 46399, 46398, 19575, 19576, 19577, 19578, 19579, 19580, 20047, 20048, 363966, 363965, 363964, 363963, 363962, 363967, 439019, 439018, 19590, 20082, 20083, 20084, 20085, 20086, 252792, 252793, 252794, 252795, 252796, 252797, 252798, 252799, 252800, 252801, 438973, 438978, 438979, 438980, 438981, 438982, 438983, 438984, 438985, 493054, 493053, 493052, 493051, 493050, 493049, 76783, 493047, 493048, 76780, 76781, 76782, 493059, 493060, 493061, 112342, 112343, 100913, 100914, 100915, 100916, 259022, 259021, 512886, 41243, 302693, 41655, 436337, 98929, 98930, 98931, 98932, 137145, 450395, 500050, 450400, 450399, 533074, 533066, 533067, 533071, 533068, 533069, 533002, 532970, 532979, 532973, 532971, 532977, 532975, 180405, 180430, 180429, 180428, 180427, 180426, 180425, 180424, 180423, 180422, 192641, 192640, 192639, 192638, 192637, 500046, 500045, 500044, 99021, 99020, 99019, 99018, 99017, 99016, 99015, 99014, 99013, 99012, 99011, 99010, 99009, 99008, 99007, 99006, 465796, 465795, 465794, 465793, 465792, 465791, 465790, 465789, 465788, 465787, 465786, 98724, 98723, 98722, 98424, 477828, 477827, 477826, 477825, 477824, 98397, 420224, 420223, 420222, 420221, 420220, 420219, 420226, 420225, 470400, 470399, 420228, 270684, 41269, 41268, 41267, 41266, 41265, 378482, 378481, 378480, 378479, 378478, 378477, 378476, 378475, 378474, 378473, 76043, 76044, 76045, 316842, 76046, 76047};
        turn_penalty = 35.11650428888172;
        expected = 3301.201003277179;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {34452, 34453, 363154, 363155, 363156, 363157, 363158, 363159, 363160, 363161, 363162, 363163, 363164, 363165, 363166, 363167, 363168, 408459, 408458, 408457, 408456, 408455, 408454, 408453, 408452, 408451, 408450, 408449, 408466, 408467, 408898, 417639, 417640, 408470, 449128, 449123, 375776, 109034, 375772, 449369, 449373, 449374, 449375, 182669, 182665, 182666, 182667, 182668, 108881, 375766, 449101, 449102, 518936, 375759, 513727, 288882, 449133, 518937, 532930, 375757, 288884, 375761, 375762, 375763, 375768, 521994, 522008, 521985, 521991, 522006, 522007, 521977, 521978, 521979, 521980, 184279, 484957, 484955, 108882, 108883, 108884, 375733, 375734, 375735, 18744, 381485, 375729, 375730, 18743, 542183, 57581, 185390, 185389, 57587, 57586, 57582, 1917, 280991, 280990, 542177, 143813, 143812, 435858, 453406, 436658, 292050, 453405, 159966, 542186, 34782, 143808, 542188, 143806, 527816, 527817, 487760, 238079, 378351, 479019, 479032, 143793, 487757, 143794, 479000, 487759, 487756, 487754, 487755, 10199, 245710, 387754, 356448, 387759, 387760, 387879, 272860, 397147, 460154, 418038, 397131, 506657, 506777, 506663, 397132, 397133, 397137, 397136, 397135, 397134, 396876, 506660, 506659, 159856, 272853, 506425, 506405, 88120, 88126, 88127, 88145, 506420, 272856, 88146, 23641, 272854, 506408, 26416, 4670, 397145, 397143, 64252, 64251, 506422, 506404, 506410, 506421, 506424, 66231, 398956, 398954, 66229, 399170, 64253, 506407, 59181, 506433, 506439, 386650, 454955, 64256, 341048, 341049, 64258, 77882, 77883, 12476, 77895, 77894, 389765, 389752, 389751, 389750, 329073, 389769, 389768, 389767, 389766, 329074, 336048, 336045, 336046, 336047, 389764, 389763, 389762, 389761, 389760, 389759, 389758, 389757, 389756, 389755, 389754, 389753, 455003, 455004, 12471, 12472, 12473, 389749, 237359, 237360, 504390, 328482, 336050, 389771, 389770, 498973, 84209, 84208, 324221, 19250, 389783, 315292, 315293, 315294, 389784, 19248, 19262, 389772, 315282, 315287, 315288, 315289, 389782, 454996, 179791, 179792, 235608, 235615, 235610, 235616};
        turn_penalty = 36.43049940423171;
        expected = 3395.462501640039;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {323564, 465998, 10312, 323563, 364196, 364193, 364194, 320980, 259482, 259483, 929, 930, 485834, 485831, 485832, 485833, 276130, 533958, 259484, 533955, 533954, 486734, 541567, 321587, 321588, 296757, 485917, 485918, 265161, 147112, 147113, 511374, 278307, 517829, 199147, 199146, 296801, 486731, 240866, 214862, 214861, 276702, 276703, 461935, 461934, 2178, 485395, 390104, 485394, 331733, 540851, 485390, 540859, 485377, 485378, 149635, 149631, 149632, 149633, 149634, 540860, 540861, 398146, 469239, 514143, 475548, 475549, 475550, 475551, 376771, 475553, 475554, 463415, 405583, 405584, 457325, 950, 353951, 453877, 475566, 339828, 173264, 288794, 173263, 17316, 463528, 17312, 17308, 363854, 363855, 376765, 376766, 483841, 283912, 283913, 283914, 283915, 266734, 21411, 513233, 279363, 522182, 522274, 522180, 522178, 519002, 21413, 279364, 522160, 522159, 522158, 521276, 521275, 521274, 326187, 398361, 398360, 326196, 326197, 326198, 326199, 326200, 326201, 326202, 326211, 326212, 184168, 184167, 184166, 184165, 184164, 184162, 184163, 184170, 184169, 455951, 306499, 306498, 306497, 535577, 535576, 535575, 535574, 535573, 107798, 350289, 522073, 326372, 245117, 245116, 245115, 245114, 245113, 245112, 245111, 245110, 71596, 71595, 71594, 71593, 71592, 289836, 289835, 289834, 289833, 289832, 289831, 289830, 289829, 289828, 289842, 289841, 289840, 289839, 289838, 289837, 289848, 289843, 289847, 524053, 524052, 524051, 524050, 524049, 524048, 524047, 472202, 472201, 295914, 295913, 295912, 295911, 295910, 295909, 295908, 71585, 71584, 71587, 518456, 301525, 301526, 301527, 210567, 4077, 471137, 471141, 471142, 471143, 471144, 435825, 435827, 435828, 435829, 435830, 471145, 471146, 205013, 268622, 513195, 435648, 268619, 338623, 268625, 284060, 284061, 283037, 284048, 283038, 283039, 283040, 283041, 264255, 264256, 264257, 539101, 539099, 539100, 168198, 168199, 168196, 264911, 380941, 380940, 338142, 338131, 284538, 284539, 284530, 284531, 146450, 65942, 451248, 451249, 291949, 291950, 291951, 291945, 436642, 65941, 336929, 336930, 380947, 380948, 380949, 264709, 380944, 380943, 380952, 380950, 65939, 65940, 436644, 436645, 436650, 436651, 65875, 65874, 451252, 451245, 380957, 380956, 275749, 275750, 436648, 436649, 1862, 1863, 408893, 380959, 380962, 408853, 7627, 372822, 367882, 380980, 451336, 428163, 402872, 484632, 484637, 535604, 535605, 53735, 53738, 53737, 53736, 56472, 371067, 53734, 53733, 53732, 53731, 402887, 402888, 402889, 542402, 542403, 400193, 400194, 369428, 369429, 369430, 369431, 369432, 542386, 399147, 399148, 399149, 399150, 399151, 542389, 542385, 504237, 544829, 544830, 544831, 544832, 544833, 544834, 544835, 544836, 544837, 544838, 544839};
        turn_penalty = 19.1722872349034;
        expected = 3456.655810413169;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {505581, 480168, 480167, 480166, 480165, 480164, 325750, 325751, 325752, 327545, 400401, 545479, 400411, 400412, 400413, 545490, 474886, 400186, 400187, 400189, 534872, 400185, 540139, 540137, 540138, 400181, 542322, 4824, 4825, 4826, 4827, 545714, 545715, 403993, 395223, 395224, 395216, 395217, 395218, 395219, 328204, 461002, 395182, 395183, 395184, 395185, 395186, 395096, 441546, 441547, 441548, 441549, 460994, 218367, 218368, 218369, 460988, 461015, 461016, 333054, 385268, 385269, 526789, 526787, 394142, 460794, 394143, 394144, 394146, 394147, 394149, 394148, 394150, 394151, 394159, 394341, 450202, 173142, 394340, 173143, 173148, 173149, 499535, 376362, 257305, 257306, 10059, 376367, 71747, 426565, 152804, 152803, 10060, 173156, 173157, 519184, 519185, 519186, 10061, 376610, 376611, 388608, 388596, 173166, 173158, 453803, 453816, 253574, 253572, 253573, 11074, 139006, 139007, 253575, 253651, 253650, 253652, 253653, 173170, 173169, 173177, 173176, 173183, 173182, 173187, 173184, 173185, 173186, 8091, 8092, 160463, 160464, 455860, 338185, 466253, 451802, 152240, 152241, 152248, 152249, 152250, 529571, 529572, 338188, 487905, 451811, 451810, 12843, 12844, 451814, 79147, 451826, 79142, 79143, 153020, 196940, 524747, 79139, 64000, 519372, 519371, 519370, 519369, 128939, 352394, 352393, 352392, 352391, 352390, 352389, 352388, 352387, 352386, 352385, 352384, 461119, 461118, 461117, 461116, 533380, 533379, 461114, 538669, 538668, 434609, 434608, 434607, 352383, 352382, 79138, 79137, 79136, 79135, 79134, 79133, 79132, 79131, 79130, 79129, 79128, 85641, 75184, 75185, 75186, 75183, 75182};
        turn_penalty = 0;
        expected = 3558.607398091871;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {330529, 330561, 330562, 330563, 330564, 330565, 330566, 330567, 330568, 330516, 330512, 330569, 330491, 330490, 330489, 291408, 6618, 6619, 410866, 410867, 410868, 281337, 451345, 410871, 490080, 397466, 397468, 380982, 380979, 380980, 451336, 451337, 402870, 151081, 325779, 451338, 451341, 451342, 536536, 536537, 395252, 395258, 211274, 211275, 250160, 250161, 250162, 395250, 540107, 540106, 540105, 540104, 395247, 395246, 395249, 9467, 540021, 540014, 540113, 540114, 540115, 540116, 395228, 395229, 395230, 540020, 540002, 540017, 395225, 395226, 395227, 460999, 461006, 461007, 461008, 461009, 461003, 451460, 460995, 395217, 395218, 395219, 328204, 461002, 395182, 395183, 395184, 395185, 395186, 395096, 441546, 441547, 441548, 441549, 460994, 218367, 218368, 218369, 460988, 461015, 461016, 333054, 385268, 385269, 526789, 526787, 394142, 460794, 394143, 394144, 394146, 394147, 394149, 394148, 394150, 394151, 394159, 394341, 450202, 173142, 394340, 173143, 173148, 173149, 499535, 376362, 257305, 257306, 10059, 376367, 71747, 426565, 152804, 152803, 10060, 173156, 173157, 519184, 519185, 519186, 10061, 376610, 376611, 388608, 388596, 173166, 173158, 453803, 453816, 253574, 253572, 253573, 11074, 139006, 139007, 253575, 253651, 253650, 253652, 253653, 173170, 173169, 173177, 173176, 173183, 173182, 173187, 173184, 173185, 173186, 44343, 450190, 363391, 69885, 406281, 479600, 66750, 173192, 669, 670, 671, 459716, 459717, 544970, 544971, 672, 459722, 441387, 665, 666, 459719, 459720, 459721, 351226, 459718, 694, 541444, 541448, 541449, 541450, 541447, 541438, 541439, 541440, 368365, 368360, 368359, 368358, 368370, 368369, 537327, 537328, 537329, 537330, 537331, 537332, 464317, 130887, 464316, 488391, 488390, 377894, 507752, 152194, 151662};
        turn_penalty = 18.53930724171296;
        expected = 3730.313044528777;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {2532, 2533, 2534, 2535, 2539, 411191, 411192, 196661, 160221, 160222, 393381, 151315, 393369, 41628, 393370, 41626, 393382, 41622, 393374, 179796, 179808, 231342, 398919, 462867, 398924, 398925, 398921, 231343, 41619, 389380, 389381, 447, 151592, 151593, 153316, 153315, 159740, 159741, 254155, 159973, 159974, 436666, 143795, 143796, 438796, 437300, 387773, 34740, 143790, 387761, 387755, 387763, 387762, 141758, 238080, 542185, 143809, 143810, 542187, 143811, 1585, 292051, 453407, 435859, 143814, 542176, 143815, 280988, 280989, 57584, 185387, 57585, 57583, 185388, 185391, 542184, 57468, 57476, 387622, 57475, 387621, 57474, 57473, 356055, 356056, 57469, 53749, 542180, 327423, 57463, 57462, 57461, 542179, 57460, 387815, 57454, 57453, 542182, 53751, 1492, 1493, 304251, 304252, 304250, 304240, 304242, 304243, 304244, 357661, 357662, 176643, 219731, 304260, 304261, 357660, 209854, 209852, 453423, 453422, 164405, 264370, 453419, 303655, 303658, 303663, 303664, 292479, 292478, 357664, 529452, 153558, 153560, 374218, 164408, 304628, 304630, 1937, 529451, 219727, 477081, 477082, 543067, 543068, 153554, 543936, 493718, 464459, 493721, 28299, 28300, 28301, 82878, 82877, 380849, 380810, 380811, 380812, 173016, 173017, 173018, 173019, 475124, 315373, 315372, 315371, 315370, 265569, 265568, 265567, 87412, 173027, 173028, 504960, 479369, 88490, 88489, 88488, 88487, 266748, 88473, 88479, 88478};
        turn_penalty = 25.71679010554763;
        expected = 3781.286810927115;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {296345, 296344, 334202, 334201, 334200, 334199, 334198, 334197, 502174, 502173, 502172, 502171, 502170, 460392, 460391, 460390, 304627, 304626, 304625, 304624, 460389, 374170, 460393, 478457, 20540, 20539, 20545, 20541, 20542, 20543, 20544, 487925, 493618, 493625, 487928, 487929, 524544, 487926, 487927, 471591, 471592, 471587, 471588, 471589, 471590, 487906, 487907, 471586, 208219, 478436, 478437, 33544, 542175, 1931, 57467, 57471, 356053, 356059, 57472, 57466, 387618, 387619, 57478, 387623, 57477, 542183, 57581, 185390, 185389, 57587, 57586, 57582, 1917, 280991, 280990, 542177, 143813, 143812, 435858, 453406, 436658, 292050, 453405, 159966, 542186, 34782, 143808, 542188, 143806, 143807, 1921, 143791, 387764, 387752, 387756, 387758, 446, 357665, 437301, 437299, 438797, 143798, 143797, 436668, 436669, 254156, 159738, 159739, 355639, 452207, 369349, 184810, 4598, 251603, 355625, 153270, 422796, 422797, 422798, 61, 398836, 398837, 398838, 398833, 398847, 327475, 327480, 327481, 327482, 327483, 379965, 379966, 379967, 177900, 177901, 184431, 184432, 398737, 398738, 398739, 398743, 398744, 398745, 205684, 205685, 398766, 398761, 398762, 398763, 398760, 190221, 190222, 190223, 190224, 190225, 190226, 190263, 190026, 190027, 133258, 133234, 133235, 190315, 190316, 190672, 190673, 59516, 398795, 352457, 352463, 301508, 42553, 42554, 342614, 489353, 489354, 489355, 489356, 489357, 489358, 489343, 59568, 59569, 59570, 59571, 59572, 59573, 59580, 59579, 59578, 59577, 59576, 59575, 59574, 60302, 60301, 60300, 60299, 60298, 51871, 51870, 51869, 39971, 489362, 489363, 364725, 364724, 364723, 364722, 364721, 364720, 59493, 364728, 364583, 364584, 53920, 53921, 53922, 364581, 364579, 526943, 489371, 474948, 474949, 59483, 474947, 489370, 543368, 422067, 422066, 422065, 23526, 23525, 539380, 539381, 539382, 539383, 539384, 539385, 342517, 422115, 422114, 422113, 422112, 422111, 422110, 422109, 24754, 24755, 24751, 24752, 422049, 489017, 489018, 489019, 489020, 489021, 489022, 489023, 489024, 489025, 489026, 489027, 489028, 489029, 489030, 489031, 489032, 184119, 489016, 489015, 489040, 489039, 489038, 489037, 489036, 511443, 511442, 511441, 511440, 350720, 350721, 374419, 350723, 273838, 273837, 273833, 273834, 273840, 273839, 108574, 108573, 108572, 108571, 108570, 108569, 108568, 108584, 108585, 108575, 108576, 108577, 108578, 108579, 108580, 108581, 133055, 133056, 272440, 272441};
        turn_penalty = 6.807275539843149;
        expected = 3926.352247602702;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {309369, 189066, 189065, 270848, 388451, 388449, 417061, 417062, 271775, 12837, 468020, 468021, 468022, 468023, 468024, 468025, 468026, 468027, 468028, 468029, 91498, 188162, 188169, 188164, 188165, 91499, 339759, 339760, 339761, 376881, 376882, 376883, 460815, 460816, 318614, 318615, 460812, 460813, 376892, 12845, 12846, 451823, 451820, 451821, 451822, 531316, 531317, 406263, 406264, 8095, 338190, 338191, 338192, 152251, 152239, 152238, 529559, 535035, 451801, 529560, 406278, 535042, 8094, 160459, 160460, 377830, 363391, 69885, 406281, 479600, 376612, 270088, 126810, 451714, 451716, 126808, 126809, 143838, 143839, 143849, 143850, 143851, 143870, 143862, 406280, 143865, 143867, 143868, 143869, 128112, 128113, 4147, 4148, 270073, 448579, 1923, 474067, 474068, 374710, 374711, 374712, 44705, 363663, 363665, 387967, 493759, 493771, 475199, 475200, 38419, 461733, 219576, 219577, 219578, 129427, 129430, 129431, 129432, 129438, 129437, 378116, 129439, 129440, 465541, 465542, 188342, 188343, 188371, 188372, 188373, 220138, 103954, 103955, 378117, 378118, 378119, 378120, 472926, 34587, 34584, 34585, 34586, 495028, 495029, 495030, 495031, 495032, 495033, 495034, 495035, 514389, 267202, 514395, 514394, 482662, 514386, 514387, 514388, 544462, 82947, 125438, 378121, 378122, 267222, 267223, 267228, 363920, 363921, 363922, 268887, 268888, 267229, 483251, 483254, 483248, 269713, 489522, 484322, 417901, 245697, 488886, 245695, 323657, 126406, 317423, 255748, 488587, 488589, 255749, 6427, 87158, 166791, 465215, 166789, 166790, 380891, 275400, 275401, 275398, 275399, 465150, 511639, 465220, 465218, 465219, 465213, 465214, 83009, 356114, 465212, 465209, 465210, 465211, 3448, 262290, 262288, 465026, 187183, 486503, 465025, 465027, 465028, 465029, 109391, 465041, 459886, 459887, 459888, 358393, 352701, 352696, 352697, 352698, 499431, 499433, 172860, 423862, 499436, 521253, 369726, 369725, 369724, 369723, 369719, 369720, 369721, 136534};
        turn_penalty = 3.429819050882873;
        expected = 3990.646368001547;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {254631, 125209, 466005, 466004, 466009, 466008, 121632, 335144, 261707, 314261, 261711, 261710, 335152, 285829, 285809, 466013, 466014, 381155, 64621, 350887, 64631, 64632, 64626, 64627, 381147, 381148, 489574, 489575, 489576, 489577, 489578, 489579, 489569, 489570, 489571, 207073, 376293, 376294, 376295, 376296, 461824, 150332, 150333, 134781, 346236, 346240, 376297, 461817, 350888, 59667, 206296, 206297, 190983, 24330, 24331, 24334, 461815, 461816, 282242, 418084, 418083, 418082, 529895, 529896, 529897, 529898, 529899, 529900, 529901, 394714, 411006, 411007, 459965, 459960, 459961, 459962, 459963, 459964, 459952, 459953, 459954, 459955, 459956, 459957, 459958, 459959, 394717, 394718, 394719, 394720, 394721, 394722, 394723, 394724, 458886, 282441, 376292, 282442, 219531, 219532, 219526, 219525, 490010, 17750, 17745, 106641, 106642, 106643, 458883, 458884, 458885, 458857, 376116, 376117, 376112, 376113, 376114, 376115, 450237, 60320, 60321, 60322, 60323, 60324, 60325, 60326, 60327, 491940, 48638, 48634, 48635, 48657, 48658, 48668, 267499, 48680, 48681, 376121, 397326, 397327, 1336, 376110, 376108, 376122, 452103, 281828, 716, 717, 718, 171461, 171460, 171450, 171453, 452097, 452101, 452098, 452100, 146442, 146445, 354696, 286974, 452094, 452092, 338159, 172365, 376350, 253482, 253481, 253480, 253479, 141421, 387962, 141422, 57033, 57032, 376358, 405659, 405661, 173137, 173135, 173138, 173140, 173145, 10058, 376361, 376362, 257305, 257306, 10059, 376367, 71747, 426565, 152804, 152803, 10060, 173156, 173157, 519184, 519185, 519186, 10061, 376610, 376611, 388608, 388596, 173166, 173158, 453803, 453816, 253574, 253572, 392790, 5238, 5239, 5240, 392837, 326217, 458557, 458558, 498680, 458555, 458556, 465777, 465778, 392838, 392839, 498681, 498682, 498683, 498684, 498685, 498686, 498687, 409045, 498605, 467919, 498606, 229655, 229656, 281661, 397830, 397835, 397727, 397743, 397731, 397732, 397733, 397744, 397752, 397751, 397750, 397749, 397753, 397741, 397742, 397745, 397748, 397775, 397771, 397772, 397773, 397774, 397766};
        turn_penalty = 34.77809088384424;
        expected = 4304.59045480985;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {262229, 75932, 265858, 265857, 355307, 355308, 75961, 75928, 75924, 75925, 75926, 75920, 494615, 494616, 28304, 164412, 164411, 28300, 28301, 28302, 38336, 161597, 188396, 188395, 76009, 219575, 378062, 1930, 270398, 270404, 144058, 144057, 270400, 178651, 453428, 187519, 187518, 304639, 178652, 304669, 304668, 129529, 129530, 246432, 387965, 412091, 412092, 412094, 38422, 387970, 387966, 387968, 387975, 55460, 363668, 1924, 1925, 1926, 1927, 1928, 448577, 144052, 474066, 78553, 4149, 453438, 188383, 363388, 270074, 270075, 406279, 143928, 128114, 128115, 128116, 143866, 143864, 69886, 143863, 143853, 143852, 143847, 143848, 143840, 126812, 126813, 451711, 451710, 451712, 126811, 270089, 376613, 479599, 69887, 4146, 363389, 363390, 4142, 11072, 11073, 520550, 173189, 173188, 173181, 173180, 173179, 173178, 173168, 173171, 4143, 4144, 4145, 253655, 253654, 253648, 253649, 139005, 139004, 253570, 253571, 453815, 453818, 253569, 173159, 388593, 388590, 388591, 376877, 393109, 253562, 178289, 253563, 393110, 393111, 393112, 393113, 314879, 314880, 314881, 314882, 403104, 403107, 403106, 403108, 403112, 458598, 458599, 458600, 458601, 458602, 458603, 458604, 458605, 458606, 458607, 458608, 358031, 358032, 358033, 358034, 457501, 457502, 457503, 457504, 457505, 404027, 132406, 132407, 132319, 132320, 151733, 412716, 404010, 404011, 404003, 404016, 404017, 404018, 358096, 358093, 358094, 520673, 520674, 520675, 520676, 18438, 18439, 440103, 440104, 440105, 431519, 431516, 431517, 431518, 317496, 317493, 317494, 317495, 405734, 405735, 358088, 358089, 358090, 358091, 358092, 124934, 124935, 124936, 233883, 124932, 124933, 358079, 358080, 466185, 466186, 466187, 466188, 466189, 457497, 457498, 441731, 457485, 457486, 457487, 457488, 457489, 457490, 457491, 457492, 457493, 6864, 117404, 344688, 344687, 341323, 341322, 341321, 341320, 341319, 341318, 341317, 338812, 481033, 481032, 481031, 481030, 481029, 481028, 481027, 481026, 481025, 481024, 481023, 481022, 481021, 117403, 117402, 481020, 481019, 481018, 481017, 481016, 443348, 443347, 443346, 443345, 443344, 362982, 524477, 524476};
        turn_penalty = 11.47564690315255;
        expected = 4412.741764965631;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {400734, 334783, 537765, 537764, 250162, 395250, 540107, 540106, 540105, 540104, 395247, 395246, 395249, 9467, 540021, 540014, 540113, 540114, 540115, 540116, 395228, 395229, 395230, 540020, 540002, 540017, 395225, 395226, 395227, 460999, 461006, 461007, 461008, 461009, 461003, 451460, 460995, 395217, 395218, 395219, 328204, 461002, 395182, 395183, 395184, 395185, 395186, 395096, 441546, 441547, 441548, 441549, 460994, 218367, 218368, 218369, 460988, 461015, 461016, 333054, 385268, 385269, 526789, 526787, 394142, 460794, 394143, 394144, 394146, 394147, 394149, 394148, 394150, 394151, 394159, 394341, 450202, 173142, 394340, 173143, 173148, 173149, 499535, 376362, 257305, 257306, 10059, 376367, 71747, 426565, 152804, 152803, 10060, 173156, 173157, 519184, 519185, 519186, 10061, 376610, 376611, 388608, 388596, 173166, 173158, 453803, 453816, 253574, 253572, 253573, 11074, 139006, 139007, 253575, 253651, 253650, 253652, 253653, 173170, 173169, 173177, 173176, 173183, 173182, 173187, 173184, 173185, 173186, 44343, 450190, 363391, 69885, 406281, 479600, 376612, 270088, 126810, 451714, 451716, 126808, 126809, 143838, 143839, 143849, 143850, 143851, 143870, 143862, 406280, 143865, 143867, 143868, 143869, 128112, 128113, 4147, 4148, 270073, 448579, 16898, 219580, 448574, 143953, 143955, 229270, 229271, 448580, 448581, 448582, 448553, 448557, 143995, 143991, 143992, 442892, 448551, 448550, 143998, 143999, 144003, 144002, 21169, 448480, 142862, 448473, 493990, 233889, 233890, 233891, 233892, 233893, 532697, 359691, 359692, 532716, 52236, 52237, 52238, 52230, 52231, 149662, 149663, 376910, 376911, 376912, 376913, 376914, 376915, 52245, 52246, 52247, 149664, 52262, 52263, 52264, 284355, 284356, 284357, 284358, 376924, 383921, 383920, 52229, 52256, 52253, 511326, 511329, 511328, 511327, 359877, 307883, 307882, 307881, 307887, 307886, 307885, 307884, 511330, 511331, 308575, 308574, 308576, 52252, 52251, 70603, 52269, 52270, 52271, 72942, 146559, 146560, 377546, 377547, 172854, 172855, 383914, 383912, 383913, 339592, 339593, 339594, 339595, 339596, 339597, 339598, 391261, 171618, 171619, 171620, 171621, 72997, 345014, 429513, 429514, 472267, 368618, 175595, 537392, 537401, 537402, 537403, 36095, 338779, 237170, 176033, 221652, 236004, 36091, 36092, 36108, 36109, 36110, 126314};
        turn_penalty = 19.45167864269119;
        expected = 4508.055104381162;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {365607, 359265, 359264, 359263, 359262, 359261, 297785, 297786, 297987, 426511, 426512, 337120, 337121, 508309, 508310, 508311, 508312, 508313, 508314, 508315, 508316, 508317, 508318, 508319, 508320, 508321, 508322, 508323, 508324, 508325, 22824, 153576, 22818, 453419, 303655, 303658, 303663, 303664, 292479, 292478, 357664, 529452, 153558, 153560, 374218, 164408, 304628, 304630, 1937, 529451, 219727, 477081, 477082, 543067, 543068, 153554, 543936, 493718, 377643, 464458, 161597, 188396, 188395, 76009, 219575, 378062, 1930, 270398, 270404, 144058, 144057, 270400, 178651, 453428, 187519, 187518, 304639, 178652, 304669, 304668, 129529, 129530, 246432, 387965, 412091, 412092, 412094, 38422, 387970, 387966, 387968, 387975, 55460, 363668, 1924, 1925, 1926, 1927, 1928, 448577, 144052, 474066, 78553, 4149, 453438, 188383, 363388, 270074, 270075, 406279, 143928, 128114, 128115, 128116, 143866, 143864, 69886, 143863, 143853, 143852, 143847, 143848, 143840, 126812, 126813, 451711, 451710, 451712, 126811, 270089, 376613, 479599, 69887, 4146, 363389, 363390, 4142, 11072, 11073, 520550, 173189, 173188, 173181, 173180, 173179, 173178, 173168, 173171, 4143, 4144, 4145, 253655, 253654, 253648, 253649, 139005, 139004, 253570, 253571, 453815, 453818, 253569, 173159, 388593, 388590, 388591, 10062, 376368, 173154, 173155, 71746, 152802, 152801, 426564, 1317, 475848, 517704, 376366, 376363, 376364, 376365, 257307, 257308, 393230, 450200, 450201, 450199, 465674, 394339, 394152, 394158, 394153, 284010, 394155, 394156, 284011, 394544, 284012, 460795, 264162, 526793, 526794, 526788, 264163, 394542, 394543, 394539, 526790, 526791, 377053, 526119, 333052, 460987, 461001, 218363, 218364, 218365, 218366, 460996, 460997, 460998, 441550, 377052, 4828, 4829, 460993, 395221, 395222, 395223, 9468, 451464, 451465, 461014, 461010, 461011, 461012, 461013, 461004, 395237, 358300, 544854, 544851, 544850, 544849, 544848, 544847, 251487, 251488, 251489, 251490, 251491, 251492, 251494, 251495};
        turn_penalty = 12.22740171002416;
        expected = 4564.363557616524;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {231141, 231142, 231143, 231121, 231120, 231119, 231118, 231117, 231116, 231115, 471843, 401661, 230775, 230776, 522986, 230777, 230782, 230781, 230780, 471839, 383544, 522984, 522981, 522982, 522983, 402555, 402563, 402562, 402561, 227142, 227137, 227138, 227124, 227125, 227126, 227144, 298124, 298125, 298126, 294650, 294651, 227128, 227129, 228630, 511889, 511890, 228631, 228629, 296665, 296666, 296667, 296668, 296669, 470244, 36128, 36129, 36130, 36131, 295848, 295849, 295850, 295851, 295852, 295853, 228649, 228650, 228651, 228652, 228653, 312736, 228622, 228621, 295099, 295100, 295101, 295823, 295824, 295825, 295826, 295827, 295828, 295829, 295830, 295831, 295832, 295833, 295834, 295835, 295836, 295837, 528222, 323853, 323854, 294350, 294351, 294352, 294353, 294354, 294317, 323877, 337118, 337119, 337114, 337115, 337116, 337117, 366616, 366609, 366617, 366618, 366619, 366620, 366621, 366622, 337109, 337110, 508308, 426510, 426511, 426512, 337120, 337121, 508309, 508310, 508311, 508312, 508313, 508314, 508315, 508316, 508317, 508318, 508319, 508320, 508321, 508322, 508323, 508324, 508325, 22824, 153576, 153577, 153578, 153579, 153574, 153572, 153573, 22815, 453420, 453421, 164400, 164399, 1933, 304259, 304258, 176642, 176640, 176641, 357659, 453415, 304241, 1932, 304249, 304248, 304253, 304254, 338139, 53750, 304239, 304237, 304238, 53752, 542181, 57455, 57456, 57457, 542178, 57459, 57458, 338186, 57465, 57464, 542175, 1931, 57467, 57471, 356053, 356059, 57472, 57466, 387618, 387619, 57478, 387623, 57477, 542183, 57581, 185390, 185389, 57587, 57586, 57582, 1917, 280991, 280990, 542177, 143813, 143812, 435858, 453406, 436658, 292050, 453405, 159966, 542186, 34782, 143808, 542188, 143806, 527816, 527817, 487760, 238079, 378351, 479019, 10200, 1102, 1103, 465135, 465136, 479800, 3734, 479793, 1087, 1088, 358240, 358241, 358242, 358243, 358244, 358245, 94860, 375864, 375865, 480898, 480891, 1007, 1008, 301788, 301789, 375862, 375863, 34162, 34157, 34158, 34159, 34160, 34161, 351636, 351637, 351633, 351622, 108974, 351628, 351629, 351630, 351631, 351632, 108975, 108976, 108977, 108978, 108979, 506390, 506391, 504227, 160352, 511913, 511914, 511915, 160353, 160354, 300347, 300348, 1034, 1035, 1036, 1037, 1038, 1039, 1040, 1041, 1042, 1043, 1044, 1045, 249360, 301748, 148240, 148239, 301749, 301750, 108980, 108981, 108982, 297526, 297527, 297528, 534257, 348602, 348603, 341001, 512988, 512982, 512973, 41802, 512966, 512967, 299510, 299509, 299508, 299507, 299506, 299505, 299504, 299503, 299502, 299501, 413958, 481790, 413956, 413955, 300494, 300495, 300496, 300497, 300498, 300499, 300500, 300501, 210285, 210286, 210287, 266274, 266275, 266276, 202447, 202448, 299499, 299498, 299497, 299496, 299495, 299494, 299493, 299482, 299483, 299484, 299485, 299486, 299487, 299488, 299489, 299490, 299491, 299492, 399471, 399472, 399473, 399474, 399475, 399476, 399477, 293951, 293952, 293953, 47690, 47689, 47688, 47687, 399767};
        turn_penalty = 20.94736646101775;
        expected = 4677.894388702052;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {75666, 75667, 75698, 75699, 75700, 75701, 75702, 75703, 75704, 75705, 75706, 75707, 75708, 75709, 75710, 75711, 75712, 75713, 215437, 215436, 215434, 215435, 505229, 505228, 12610, 249757, 249756, 213731, 75803, 213737, 213738, 213739, 75795, 517695, 213733, 213734, 213735, 376879, 376878, 78441, 378839, 378840, 378841, 25401, 436109, 448575, 448576, 78556, 78554, 474068, 374710, 374711, 374712, 44705, 363663, 363665, 387967, 493759, 493771, 475199, 475200, 38419, 461733, 219576, 219577, 219578, 129427, 129430, 129431, 129432, 129438, 129437, 378116, 129439, 129440, 465541, 465542, 188342, 188343, 188371, 188372, 188373, 220138, 103954, 103955, 378117, 378118, 378119, 378120, 472926, 34587, 34584, 34585, 34586, 495028, 495029, 495030, 495031, 495032, 495033, 495034, 495035, 514389, 267202, 514395, 514394, 482662, 514386, 514387, 514388, 544462, 34562, 34561, 34560, 34559, 34558, 34557, 34556, 34555, 34554, 34553, 34552, 34551, 34550, 34549, 34548, 34547, 34546, 265923, 265922, 265924, 265921, 494292, 494291, 494290, 494293, 276187, 276186, 276185, 276184, 276183, 276182, 276181, 276180, 276179, 276178, 276177, 378405, 378404, 378403, 378402, 378401, 378400, 193529, 273682, 467193, 467194, 378398, 378399, 377244, 377245, 529143, 5672, 5673, 104859, 275204, 378406, 275216, 306790, 306774, 306773, 306772, 306771, 306770, 306769, 306768, 306767, 193500, 193499, 261735, 261734, 261733, 261732, 261731, 261730, 261729, 261728, 261727, 261726, 261725, 261724, 261723, 5678, 449309, 449310, 449311, 449312, 274716, 499491, 124768, 124769, 267881, 267880, 267879, 543037, 267878, 362476, 541544, 471870, 511051, 527216, 527215, 472480, 203906, 400020, 447713, 62966, 62965, 62964, 62963, 62962, 62961, 104857, 104856, 5668, 5669, 5670, 534984, 534983, 398630, 398631, 398632, 398633, 398634, 398635, 398636, 267882, 267883, 267884, 267885, 267886, 267887, 203180, 509160, 203179, 304198, 304199, 489486, 489487, 335189, 335180, 335181, 335182, 335183, 335184, 335185, 229586, 323645, 323646, 323647, 323648, 471398, 309378, 309379, 363823, 363824, 309376, 309377, 488521, 488522, 465752, 465757, 465758, 465924, 465923, 112434, 257336, 470902, 470903, 470904, 470905, 470906, 470907, 470901, 542555, 542954, 542626, 542553, 542607, 542556, 542615, 467221, 492685, 492686, 537333, 537334, 537335, 537336, 537337, 537338, 537339, 537340, 488877, 488878, 488879, 459046, 523455, 523456, 494269, 494268, 494267, 229259, 535264, 535263, 535262, 535261, 535260, 535259, 535258, 444060, 444059, 499119, 499118, 499117, 499116, 499115, 499114, 257768, 515548, 499124, 282351, 459037, 282354, 526381, 499111, 323753, 540726, 499112, 463610, 369639, 369640, 451373, 521947, 521943, 500360, 521942, 151180, 151181, 521932, 521933, 521934, 521935, 521936, 521937, 521938, 521939, 521940, 521941, 516475, 516474, 516473, 517652, 30441, 27250, 27249, 450858, 450857, 143187, 252804, 301873, 17246, 470540, 470541, 17245, 335625, 367626, 490467, 494193, 494195, 494194, 468542, 468541, 468540, 17243, 57511, 57512, 283611, 283612, 57506, 57507, 57508, 57509, 57510, 4922, 4923, 4924, 486539, 342329, 486540, 486541, 486542, 486533, 486534, 486535, 484491, 486537, 486538, 316273, 499692, 499693, 276112, 280569, 457323, 457324, 100711, 138437, 107937, 217292, 217293, 479846, 479847, 382930};
        turn_penalty = 44.58619277333234;
        expected = 4688.049941822987;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {501122, 270466, 359155, 293018, 293019, 480067, 194870, 480075, 257708, 257675, 288786, 532826, 521830, 521831, 352046, 543495, 543496, 352053, 543497, 352045, 287011, 543498, 387994, 387995, 449307, 542269, 350084, 473850, 473851, 502724, 472255, 514146, 514147, 514145, 183479, 282346, 282345, 183483, 502732, 502737, 502735, 44499, 44498, 296599, 296598, 296597, 296617, 23327, 46185, 46186, 46187, 46188, 82005, 503964, 502198, 502199, 491775, 367822, 367823, 484747, 511776, 520203, 248023, 248024, 248025, 248026, 344808, 485070, 484487, 484488, 358320, 458411, 458412, 468573, 484746, 468589, 484740, 484743, 484741, 289698, 288628, 268972, 465628, 465629, 268973, 484716, 280572, 280571, 29652, 485798, 485799, 485800, 484694, 54404, 54405, 54406, 54407, 54408, 484504, 479844, 217292, 217293, 479846, 479847, 479841, 479842, 479836, 533762, 496075, 449407, 278403, 278404, 278405, 416955, 479829, 463419, 463416, 463417, 463423, 532482, 463422, 217291, 532353, 532352, 530999, 532351, 532363, 532355, 532356, 532357, 532378, 532379, 532354, 532358, 532359, 532360, 529125, 529126, 291580, 291574, 291575, 291576, 291577, 291578, 291579, 2441, 283490, 283491, 283492, 283493, 283494, 283495, 283496, 283497, 283498, 283499, 283500, 283501, 283502, 283503, 283504, 283505, 283506, 330979, 330980, 330981, 330982, 330983, 330984, 330985, 330986, 330987, 330988, 330989, 330990, 399780, 399781, 399782, 399783, 484516, 484517, 484513, 494205, 494206, 472353, 494207, 494208, 494209, 302205, 302206, 302207, 302208, 279189, 321880, 321881, 321882, 321883, 321884, 315480, 315481, 315482, 315483, 315484, 315485, 315486, 315487, 315488, 315489, 315490, 442979, 442978, 11782, 11783, 11784, 350364, 350365, 350366, 350367, 350368, 350369, 350370, 350371, 350372, 350373, 350374, 350375, 11785, 11786, 11787, 11788, 11789, 11790, 11791, 532672, 532673, 532674, 297500, 297496, 297497, 297498, 297499, 532747, 532748, 532749, 532750, 11781, 532742, 302675, 302676, 302677, 284776, 266565, 266566, 266567, 302146, 302147, 4940, 95789, 300562, 519241, 519242, 479895, 3733, 479898, 479897, 6438, 6439, 300510, 95817, 160314, 160313, 160359, 160378, 160380, 160381, 356295, 356294, 160396, 160397, 258782, 476868, 476869, 476870, 476871, 184589, 184588, 436077, 184627, 184626, 184805, 184806, 184807, 159730, 159729, 289549, 289550, 289551, 389373, 389370, 389371, 257384, 257382, 257383, 153309, 393118, 465546, 355636, 389379, 389378, 474520, 474516, 231340, 474518, 181543, 231344, 173347, 474517, 179810, 179809, 41624, 41625, 393372, 41627, 41629, 41630, 393371, 151316, 393376, 393377, 160219, 393507, 393508, 393511, 393506, 357658, 393518, 393519, 393520, 457963, 104073, 41613, 475985, 204257, 53831, 53838, 53837, 84123, 84124, 84125, 351254, 84118, 84119, 84122, 490663, 351719, 351718, 351717, 351716, 351715, 351714, 351713, 351712, 351711, 151148, 537920, 537919, 537918, 537917, 537916, 537915, 309227, 151152, 309269, 445137, 213966, 213965, 213964, 213963, 213962, 151147, 59759, 59758, 394474, 394481, 387476, 387475, 387474, 214398};
        turn_penalty = 44.77880467381614;
        expected = 4714.357729741008;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {468462, 468461, 48986, 48983, 48987, 48981, 514597, 514596, 514595, 514594, 514593, 514592, 514591, 514590, 514589, 323092, 323091, 369308, 369307, 369306, 369305, 369311, 369310, 369309, 389527, 389526, 389525, 389524, 44196, 44195, 12730, 12731, 12724, 58386, 58387, 389541, 389542, 389543, 389559, 389560, 389551, 389552, 389553, 389522, 389523, 389533, 389558, 389538, 59111, 59112, 102086, 102087, 80670, 91460, 91461, 80669, 389521, 305501, 12721, 305493, 58389, 389532, 12706, 13258, 234687, 58390, 58007, 58010, 58011, 387613, 387614, 166116, 166117, 166086, 166087, 166088, 387608, 387609, 387610, 537694, 537695, 537696, 387615, 387616, 387617, 11102, 11103, 11097, 375989, 375990, 375991, 375992, 487647, 375743, 375744, 376100, 156029, 375741, 375728, 375729, 375730, 18743, 542183, 57581, 185390, 185389, 57587, 57586, 57582, 1917, 280991, 280990, 542177, 143813, 143812, 435858, 453406, 436658, 292050, 453405, 159966, 542186, 34782, 143808, 542188, 143806, 527816, 527817, 487760, 238079, 378351, 479019, 10200, 1102, 1103, 465135, 465136, 479800, 3734, 479793, 1087, 1088, 358240, 358241, 358242, 358243, 358244, 358245, 94860, 375864, 375865, 480898, 480891, 1007, 1008, 301788, 301789, 375862, 375863, 34162, 34157, 34158, 34159, 34160, 34161, 351636, 351637, 351633, 351622, 108974, 351628, 351629, 351630, 351631, 351632, 108975, 108976, 108977, 108978, 108979, 506390, 506391, 504227, 160352, 511913, 511914, 511915, 160353, 160354, 300347, 300348, 1034, 1035, 1036, 1037, 1038, 1039, 1040, 1041, 1042, 1043, 1044, 1045, 249360, 300350, 364085, 364086, 363472, 480885, 480884, 480882, 40054, 363469, 376012, 40058, 160307, 523514, 523511, 416801, 302399, 302400, 302401, 302402, 538476, 538477, 538478, 503859, 503852, 162510, 162511, 300548, 300549, 40045, 40044, 300541, 300542, 300543, 300544, 300545, 300546, 512350, 512351, 512352, 517312, 517313, 302390, 302391, 302392, 302383, 302384, 302385, 302386, 488046, 339782, 339783, 476619, 476610, 488048, 488047, 352216, 81426, 352197, 529048, 529049, 529050, 529051, 482372, 376204, 376203, 376202, 376201, 529046, 529045, 485108, 485109, 529044, 485110, 529043, 71, 70, 284982, 477322, 477321, 284981, 284980, 477320, 477319, 297542, 297541, 297540, 515177, 515180, 515178, 529040, 81423, 515175, 512418, 512419, 512420, 512421, 512422, 285119, 285116, 285117, 285118, 81416, 81417, 512417, 512415, 485629, 485630, 485631, 485632, 485633, 485634, 485635, 485636, 485637, 485638, 210569, 210568, 295920, 378418, 518458, 295921, 295907, 301525, 301526, 301527, 418122, 518453, 518454, 489897, 489898, 418119, 418120, 418121, 110484, 274327, 450893, 18436, 18435, 18434, 514029, 514030, 514031, 514032, 416372, 416373, 416374, 416375, 416350, 416351, 416352, 416353, 416354, 416355, 416356, 416357, 416358, 416359, 416360, 416361, 416362, 416363, 416364, 416365, 416366, 416367, 416368, 416369, 416370, 416371, 303036, 418210, 418211, 274616, 274617, 274618, 418223, 274614, 274613, 389628, 389630, 389629, 543167, 543166, 389627, 389626, 389625, 389624, 389623, 391047, 391046, 391045, 391044, 391043, 391042, 391041, 391040, 438732, 438731, 438730, 438729, 438728, 438727, 438726, 438725, 438724, 438723, 438722, 438721, 438720, 391049, 18654, 51884, 51883, 51882, 363488, 395483, 395484, 395482, 363495, 464853, 363500, 363501, 395485, 395486, 395487, 395488, 395489, 395490, 395491, 395492, 363503, 509683, 509684, 509685, 509686, 509687, 363511, 260828, 260827, 260826, 260825, 260824, 260823, 68771, 68770, 68769, 68768, 18655, 246185, 246186, 246187, 246188, 246189, 246190, 246191, 246192, 246193, 246194, 246195, 246196, 246197, 246198, 246199, 246200, 246201, 246202, 246203, 246204, 498340, 498341, 498336, 498337, 498338, 498339, 275795, 275796, 364037, 364038, 498334, 498335, 519616, 417857, 302978, 269447, 474740, 269448, 474146, 417863, 417864, 417865, 417866, 206359, 206360, 206355, 206356, 206357, 206358, 474145, 417870, 417871, 474149, 474150, 269446, 206352, 444893, 175931, 109258, 109259, 170467, 170468};
        turn_penalty = 23.17018073295285;
        expected = 4978.972633635691;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {215881, 48908, 76885, 76886, 76887, 76888, 76889, 76890, 76891, 76892, 76893, 76894, 18604, 18605, 18606, 135683, 135684, 135685, 135686, 135687, 135688, 135689, 135690, 135691, 135692, 143406, 143403, 143404, 138837, 138838, 138839, 478752, 458686, 472415, 472416, 472417, 472402, 472398, 472399, 472400, 468838, 478747, 96237, 96236, 96235, 96242, 96234, 478749, 478748, 96227, 96228, 96229, 96225, 535448, 162699, 162700, 162701, 96220, 451828, 12846, 451823, 451820, 451821, 451822, 531316, 531317, 406263, 406264, 8095, 338190, 338191, 338192, 152251, 152239, 152238, 529559, 535035, 451801, 529560, 406278, 535042, 8094, 160459, 160460, 377830, 363391, 69885, 406281, 479600, 376612, 270088, 126810, 451714, 451716, 126808, 126809, 143838, 143839, 143849, 143850, 143851, 143870, 143862, 406280, 143865, 143867, 143868, 143869, 128112, 128113, 4147, 4148, 270073, 448579, 1923, 474067, 474068, 374710, 374711, 374712, 374713, 363662, 363664, 38421, 387964, 387974, 387973, 387971, 1929, 412093, 412095, 387969, 246433, 129531, 129532, 304667, 178653, 505418, 505419, 304640, 304641, 187517, 178650, 453427, 270401, 270399, 144056, 144059, 270403, 270402, 451693, 1934, 512298, 376701, 493794, 259208, 259209, 75950, 543940, 543941, 543942, 543943, 1935, 477083, 464451, 464452, 173006, 142701, 142702, 142703, 153552, 477076, 477080, 38334, 427032, 427033, 427034, 427027, 427028, 427025, 530160, 427029, 38268, 219729, 153561, 153562, 512303, 512304, 512305, 38635, 263084, 357663, 181728, 181729, 303661, 303662, 303659, 303660, 453426, 164406, 164404, 453420, 453421, 164400, 164399, 1933, 304259, 304258, 176642, 176640, 176641, 28047, 453417, 453414, 453411, 358516, 358517, 358518, 176634, 176633, 387818, 182865, 182866, 182851, 6442, 6443, 32140, 32141, 32142, 32146, 182822, 182823, 32139, 374705, 33364, 33366, 33367, 182859, 182860, 182861, 20564, 20563, 506053, 506052, 506051, 506050, 506049, 462476, 462475, 403580, 403581, 281291, 281290, 281289, 281288, 281287, 281286, 281285, 281284, 281283, 281282, 281281, 515117, 515116, 163482, 163504, 163505};
        turn_penalty = 33.45806031895192;
        expected = 5142.789476037869;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
        path = {210880, 210879, 488808, 317096, 317095, 210869, 210870, 312937, 392833, 392825, 392826, 392827, 392828, 392829, 392830, 392831, 392832, 326725, 326726, 326727, 262326, 262327, 267766, 263824, 414392, 221600, 221843, 309586, 21550, 21551, 378179, 378180, 343417, 343418, 426293, 426290, 239914, 239915, 239916, 239917, 378175, 309582, 309579, 215976, 215977, 245103, 437007, 21555, 437006, 245104, 378171, 378172, 21558, 281605, 281601, 281602, 281603, 281604, 73736, 73737, 73738, 73739, 73740, 393700, 378166, 378174, 280878, 280879, 21618, 21619, 221813, 221814, 400375, 400376, 400377, 205144, 378187, 205143, 435161, 435162, 435163, 206195, 205539, 205540, 378188, 378189, 205548, 394907, 420804, 420805, 420806, 420807, 420808, 420809, 205976, 205975, 393691, 34520, 359976, 359975, 512311, 421033, 421029, 22807, 453423, 453422, 164405, 264370, 453419, 303655, 303658, 303663, 303664, 292479, 292478, 357664, 529452, 153558, 153560, 374218, 164408, 304628, 304630, 1937, 529451, 219727, 477081, 477082, 543067, 543068, 153554, 543936, 493718, 377643, 464458, 161597, 188396, 188395, 76009, 219575, 378062, 1930, 270398, 270404, 144058, 144057, 270400, 178651, 453428, 187519, 187518, 304639, 178652, 304669, 304668, 129529, 129530, 246432, 387965, 412091, 412092, 412094, 38422, 387970, 387966, 387968, 387975, 55460, 363668, 1924, 1925, 1926, 1927, 1928, 448577, 144052, 474066, 78553, 4149, 453438, 188383, 363388, 270074, 270075, 406279, 143928, 128114, 128115, 128116, 143866, 143864, 69886, 143863, 143853, 143852, 143847, 143848, 143840, 126812, 126813, 451711, 451710, 451712, 126811, 270089, 376613, 479599, 69887, 4146, 363389, 363390, 4142, 11072, 11073, 520550, 173189, 173188, 173181, 173180, 173179, 173178, 173168, 173171, 4143, 4144, 4145, 253655, 253654, 253648, 253649, 139005, 139004, 253570, 253571, 453815, 453818, 253569, 173159, 388593, 388590, 388591, 10062, 376368, 173154, 173155, 71746, 152802, 152801, 426564, 1317, 475848, 517704, 393102, 384557, 446167, 459848, 446166, 495460, 410133, 410131, 410089, 410088, 410084, 410095, 410096, 410097, 410087, 525217, 525216, 525215, 525214, 525213, 525212, 525211, 473948, 473947, 473946, 473945, 312359, 312358, 473951, 473950, 525221, 473949, 473955, 473954, 473953, 473952, 410083, 410082, 410081, 410080, 410079, 410090, 473956, 503596, 503597, 409107, 409099, 503595, 503589, 503590, 503591, 503592, 503593, 503594, 524064, 524063, 524062, 524061, 524283, 524282, 524281, 524280, 524279, 524278, 524277, 524276, 524275, 524274, 524273, 524272, 524271, 524270, 524269, 524268, 524267, 524266, 524265, 524264, 524263, 524255, 524254, 312509, 403881, 403844, 403845, 403846, 403847, 403848, 403877, 403883, 524284, 524285, 524286, 524287, 524288, 524289, 524290, 524291, 524292, 524293, 524294, 524295, 524296, 524297, 524298, 524299, 524300, 524301, 524302, 524303, 524304, 524305, 524306, 524307, 524308, 524309, 524310, 524311, 524312, 524313, 524314, 524315, 524316, 524317, 524318, 524319, 524320, 524321, 524322, 524323, 524324, 524325, 524326, 524327, 524328, 524329, 524330, 524331, 524332, 524333, 524334, 524335, 524336, 524337, 524338, 524339, 524340, 524341, 524342, 524343, 194066, 194067, 194068, 194069, 194070, 194071, 194072, 194073, 194074, 194075, 194076, 194077, 194078, 194079, 194080, 194081, 194082, 194083, 194084, 194085, 194086, 194087, 194088, 194089, 194090, 194091, 194092, 194093, 194094, 193904, 193905, 193906, 193907, 193908, 193909, 193910, 193911, 193912, 193913, 193914, 193915, 193916, 193917, 193918, 193919};
        turn_penalty = 30.33507082458858;
        expected = 6607.761290846442;
        actual = compute_path_travel_time(path, turn_penalty);
        CHECK(relative_error(expected, actual) < 0.001);
        
    } //path_cost_london_england

} //path_cost_london_england_public

